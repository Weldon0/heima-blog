---
title: ğŸ“š 08-å‘˜å·¥ç®¡ç†
---
## å°è£…ä¸€ä¸ªé€šç”¨çš„å·¥å…·æ 

**`ç›®æ ‡`**ï¼šå°è£…ä¸€ä¸ªé€šç”¨çš„å·¥å…·æ ä¾›å¤§å®¶ä½¿ç”¨

### é€šç”¨å·¥å…·æ çš„ç»„ä»¶ç»“æ„

> åœ¨åç»­çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°ä¸€ä¸ªç±»ä¼¼ä¸‹å›¾çš„å·¥å…·æ ï¼Œä½œä¸ºå…¬å…±ç»„ä»¶ï¼Œè¿›è¡Œä¸€ä¸‹å°è£…

![image-20200723223704401](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200723223704401.png)

ç»„ä»¶ **`src/components/PageTools/index.vue`**

```vue
<template>
  <el-card class="page-tools">
    <el-row type="flex" justify="space-between" align="middle">
      <el-col>
        <div  v-if="showBefore" class="before">
          <i class="el-icon-info" />
          <!-- å®šä¹‰å‰é¢å¾—æ’æ§½ -->
          <slot name="before" />
        </div>
      </el-col>
      <el-col>
        <el-row type="flex" justify="end">
           <!-- å®šä¹‰åé¢çš„æ’æ§½ -->
           <slot name="after" />
        </el-row>
      </el-col>
    </el-row>
  </el-card>
</template>

<script>
export default {
  props: {
    showBefore: {
      type: Boolean,
      default: false
    }

  }
}
</script>

<style lang='scss'>
 .page-tools {
    margin: 10px 0;
    .before {
      line-height: 34px;
    i {
      margin-right: 5px;
      color: #409eff;
    }
    display: inline-block;
    padding: 0px 10px;
    border-radius: 3px;
    border: 1px solid rgba(145, 213, 255, 1);
    background: rgba(230, 247, 255, 1);
  }
 }
</style>

```

### ç»„ä»¶ç»Ÿä¸€æ³¨å†Œ

> ä¸ºäº†æ–¹ä¾¿æ‰€æœ‰çš„é¡µé¢éƒ½å¯ä»¥ä¸ç”¨å¼•ç”¨è¯¥ç»„ä»¶ï¼Œå¯ä»¥è¿›è¡Œå…¨å±€æ³¨å†Œ

æä¾›æ³¨å†Œå…¥å£ **`src/componets/index.js`**

```js
// è¯¥æ–‡ä»¶è´Ÿè´£æ‰€æœ‰çš„å…¬å…±çš„ç»„ä»¶çš„å…¨å±€æ³¨å†Œ   Vue.use
import PageTools from './PageTools'
export default {
  install(Vue) {
    //  æ³¨å†Œå…¨å±€çš„é€šç”¨æ ç»„ä»¶å¯¹è±¡
    Vue.component('PageTools', PageTools)
  }
}
```

> åœ¨å…¥å£å¤„è¿›è¡Œæ³¨å†Œ **`src/main.js`**

```js
import Component from '@/components'
Vue.use(Component) // æ³¨å†Œè‡ªå·±çš„æ’ä»¶
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**ï¼š å°è£…ä¸€ä¸ªé€šç”¨çš„å·¥å…·æ 

## å‘˜å·¥åˆ—è¡¨é¡µé¢çš„åŸºæœ¬å¸ƒå±€å’Œç»“æ„

**`ç›®æ ‡`**ï¼šå®ç°å‘˜å·¥åˆ—è¡¨é¡µé¢çš„åŸºæœ¬å¸ƒå±€å’Œç»“æ„

**ç»“æ„ä»£ç ** **`src/employees/index.vue`**

```vue
<template>
  <div class="dashboard-container">
    <div class="app-container">
      <page-tools :show-before="true">
        <span slot="before">å…±166æ¡è®°å½•</span>
        <template slot="after">
          <el-button size="small" type="warning">å¯¼å…¥</el-button>
          <el-button size="small" type="danger">å¯¼å‡º</el-button>
          <el-button size="small" type="primary">æ–°å¢å‘˜å·¥</el-button>
        </template>
      </page-tools>
      <!-- æ”¾ç½®è¡¨æ ¼å’Œåˆ†é¡µ -->
      <el-card>
        <el-table border>
          <el-table-column label="åºå·" sortable="" />
          <el-table-column label="å§“å" sortable="" />
          <el-table-column label="å·¥å·" sortable="" />
          <el-table-column label="è˜ç”¨å½¢å¼" sortable="" />
          <el-table-column label="éƒ¨é—¨" sortable="" />
          <el-table-column label="å…¥èŒæ—¶é—´" sortable="" />
          <el-table-column label="è´¦æˆ·çŠ¶æ€" sortable="" />
          <el-table-column label="æ“ä½œ" sortable="" fixed="right" width="280">
            <template>
              <el-button type="text" size="small">æŸ¥çœ‹</el-button>
              <el-button type="text" size="small">è½¬æ­£</el-button>
              <el-button type="text" size="small">è°ƒå²—</el-button>
              <el-button type="text" size="small">ç¦»èŒ</el-button>
              <el-button type="text" size="small">è§’è‰²</el-button>
              <el-button type="text" size="small">åˆ é™¤</el-button>
            </template>
          </el-table-column>
        </el-table>
        <!-- åˆ†é¡µç»„ä»¶ -->
        <el-row type="flex" justify="center" align="middle" style="height: 60px">
          <el-pagination layout="prev, pager, next" />
        </el-row>
      </el-card>
    </div>
  </div>
</template>
```

![image-20200831162222975](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200831162222975.png)

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**ï¼šå‘˜å·¥åˆ—è¡¨é¡µé¢çš„åŸºæœ¬å¸ƒå±€å’Œç»“æ„

## å‘˜å·¥åˆ—è¡¨æ•°æ®è¯·æ±‚å’Œåˆ†é¡µåŠ è½½

**`ç›®æ ‡`**å®ç°å‘˜å·¥æ•°æ®çš„åŠ è½½å’Œåˆ†é¡µè¯·æ±‚

é¦–å…ˆï¼Œå°è£…å‘˜å·¥çš„åŠ è½½è¯·æ±‚ **`src/api/employees.js`**

```js
/**
 * è·å–å‘˜å·¥çš„ç»¼åˆåˆ—è¡¨æ•°æ®
 * ***/
export function getEmployeeList(params) {
  return request({
    url: '/sys/user',
    params
  })
}

```

ç„¶åï¼Œå®ç°åŠ è½½æ•°æ®å’Œåˆ†é¡µçš„é€»è¾‘

```js
import { getEmployeeList } from '@/api/employees'
export default {
  data() {
    return {
      loading: false,
      list: [], // æ¥æ•°æ®çš„
      page: {
        page: 1, // å½“å‰é¡µç 
        size: 10,
        total: 0 // æ€»æ•°
      }

    }
  },
  created() {
    this.getEmployeeList()
  },
  methods: {
    changePage(newPage) {
      this.page.page = newPage
      this.getEmployeeList()
    },
    async getEmployeeList() {
      this.loading = true
      const { total, rows } = await getEmployeeList(this.page)
      this.page.total = total
      this.list = rows
      this.loading = false
    }
  }
}
```

**ç»‘å®šè¡¨æ ¼**

```vue
      <el-card v-loading="loading">
        <el-table border :data="list">
          <el-table-column label="åºå·" sortable="" type="index" />
          <el-table-column label="å§“å" sortable="" prop="username" />
          <el-table-column label="å·¥å·" sortable="" prop="workNumber" />
          <el-table-column label="è˜ç”¨å½¢å¼" sortable="" prop="formOfEmployment" />
          <el-table-column label="éƒ¨é—¨" sortable="" prop="departmentName" />
          <el-table-column label="å…¥èŒæ—¶é—´" sortable="" prop="timeOfEntry" />
          <el-table-column label="è´¦æˆ·çŠ¶æ€" sortable="" prop="enableState" />
          <el-table-column label="æ“ä½œ" sortable="" fixed="right" width="280">
            <template>
              <el-button type="text" size="small">æŸ¥çœ‹</el-button>
              <el-button type="text" size="small">è½¬æ­£</el-button>
              <el-button type="text" size="small">è°ƒå²—</el-button>
              <el-button type="text" size="small">ç¦»èŒ</el-button>
              <el-button type="text" size="small">è§’è‰²</el-button>
              <el-button type="text" size="small">åˆ é™¤</el-button>
            </template>
          </el-table-column>
        </el-table>
        <!-- åˆ†é¡µç»„ä»¶ -->
        <el-row type="flex" justify="center" align="middle" style="height: 60px">
          <el-pagination
            layout="prev, pager, next"
            :page-size="page.size"
            :current-page="page.page"
            :total="page.total"
            @current-change="changePage"
          />
        </el-row>
      </el-card>
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**å‘˜å·¥åˆ—è¡¨æ•°æ®è¯·æ±‚å’Œåˆ†é¡µåŠ è½½

## å‘˜å·¥åˆ—è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ ¼å¼åŒ–

**`ç›®æ ‡`**ï¼šå°†åˆ—è¡¨ä¸­çš„å†…å®¹è¿›è¡Œæ ¼å¼åŒ–

### åˆ©ç”¨åˆ—æ ¼å¼åŒ–å±æ€§å¤„ç†è˜ç”¨å½¢å¼

![image-20200724001315166](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200724001315166.png)

> ä¸Šå°èŠ‚ä¸­ï¼Œåˆ—è¡¨ä¸­çš„**è˜ç”¨å½¢å¼**/**å…¥èŒæ—¶é—´**å’Œ**è´¦æˆ·çŠ¶æ€**éœ€è¦è¿›è¡Œæ˜¾ç¤ºå†…å®¹çš„å¤„ç†

é‚£ä¹ˆè˜ç”¨å½¢å¼ä¸­**1**ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Œè¿™å®é™…ä¸Šæ˜¯æˆ‘ä»¬éœ€è¦çš„æšä¸¾æ•°æ®ï¼Œè¯¥æ•°æ®çš„å­˜æ”¾æ–‡ä»¶ä½äºæˆ‘ä»¬æä¾›çš„**`èµ„æº/æšä¸¾`**ä¸­ï¼Œå¯ä»¥å°†æšä¸¾ä¸‹çš„æ–‡ä»¶å¤¹æ”¾äº**`src/api`**æ–‡ä»¶å¤¹ä¸‹

é’ˆå¯¹**è˜ç”¨å½¢å¼**ï¼Œå¯ä»¥ä½¿ç”¨**el-table-column**çš„**formatter**å±æ€§è¿›è¡Œè®¾ç½®

```js
  import    EmployeeEnum from '@/api/constant/employees'
 <!-- æ ¼å¼åŒ–è˜ç”¨å½¢å¼ -->
    <el-table-column label="è˜ç”¨å½¢å¼" sortable :formatter="formatEmployment" />
   // æ ¼å¼åŒ–è˜ç”¨å½¢å¼
    formatEmployment(row, column, cellValue, index) {
      // è¦å»æ‰¾ 1æ‰€å¯¹åº”çš„å€¼
      const obj = EmployeeEnum.hireType.find(item => item.id === cellValue)
      return obj ? obj.value : 'æœªçŸ¥'
    }
```

### è¿‡æ»¤å™¨è§£å†³æ—¶é—´æ ¼å¼çš„å¤„ç†

é’ˆå¯¹å…¥èŒæ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨**ä½œç”¨åŸŸæ’æ§½**è¿›è¡Œå¤„ç†

```vue
 <el-table-column label="å…¥èŒæ—¶é—´" sortable prop="timeOfEntry">
            <template slot-scope="obj">
              {{
                obj.row.timeOfEntry | è¿‡æ»¤å™¨
              }}
            </template>
  </el-table-column>
```

> é—®é¢˜æ¥äº†ï¼Œè¿‡æ»¤å™¨ä»å“ªé‡Œå‘¢ï¼Ÿ

åœ¨**`èµ„æº/è¿‡æ»¤å™¨`**ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†è‹¥å¹²å·¥å…·æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è½¬åŒ–æˆè¿‡æ»¤å™¨ï¼Œé¦–å…ˆå°†å…¶æ‹·è´åˆ°**`src`**

åœ¨**`main.js`**ä¸­å°†å·¥å…·æ–¹æ³•è½¬åŒ–æˆè¿‡æ»¤å™¨

```js
import * as filters from '@/filters' // å¼•å…¥å·¥å…·ç±»
// æ³¨å†Œå…¨å±€çš„è¿‡æ»¤å™¨
Object.keys(filters).forEach(key => {
  // æ³¨å†Œè¿‡æ»¤å™¨
  Vue.filter(key, filters[key])
})
```

> å¥½äº†ï¼Œç°åœ¨å¯ä»¥æ„‰å¿«çš„ç”¨è¿‡æ»¤å™¨çš„æ–¹å¼ä½¿ç”¨å·¥å…·ç±»çš„æ–¹æ³•äº†

```vue
       <el-table-column label="å…¥èŒæ—¶é—´" sortable="" align="center">
            <!-- ä½œç”¨åŸŸæ’æ§½ -->
            <template slot-scope="{ row }">{{ row.timeOfEntry | formatDate }}</template>
       </el-table-column>
```

æœ€åä¸€é¡¹ï¼Œè´¦æˆ·çŠ¶æ€ï¼Œå¯ä»¥ç”¨å¼€å…³ç»„ä»¶switchè¿›è¡Œæ˜¾ç¤º

```vue
 <el-table-column label="è´¦æˆ·çŠ¶æ€" align="center" sortable="" prop="enableState">
            <template slot-scope="{ row }">
              <!-- æ ¹æ®å½“å‰çŠ¶æ€æ¥ç¡®å®š æ˜¯å¦æ‰“å¼€å¼€å…³ -->
              <el-switch :value="row.enableState === 1" />
            </template>
    </el-table-column>
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`** å‘˜å·¥åˆ—è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ ¼å¼åŒ–

## åˆ é™¤å‘˜å·¥åŠŸèƒ½

**`ç›®æ ‡`**å®ç°åˆ é™¤å‘˜å·¥çš„åŠŸèƒ½

é¦–å…ˆå°è£… åˆ é™¤å‘˜å·¥çš„è¯·æ±‚

```js
/**
 * åˆ é™¤å‘˜å·¥æ¥å£
 * ****/

export function delEmployee(id) {
  return request({
    url: `/sys/user/${id}`,
    method: 'delete'
  })
}
```

**åˆ é™¤åŠŸèƒ½**

```vue
 <template slot-scope="{ row }">
              <el-button type="text" size="small">æŸ¥çœ‹</el-button>
              <el-button type="text" size="small">è½¬æ­£</el-button>
              <el-button type="text" size="small">è°ƒå²—</el-button>
              <el-button type="text" size="small">ç¦»èŒ</el-button>
              <el-button type="text" size="small">è§’è‰²</el-button>
              <el-button type="text" size="small" @click="deleteEmployee(row.id)">åˆ é™¤</el-button>
            </template> 
    // åˆ é™¤å‘˜å·¥
    async deleteEmployee(id) {
      try {
        await this.$confirm('æ‚¨ç¡®å®šåˆ é™¤è¯¥å‘˜å·¥å—')
        await delEmployee(id)
        this.getEmployeeList()
        this.$message.success('åˆ 
é™¤å‘˜å·¥æˆåŠŸ')
      } catch (error) {
        console.log(error)
      }
    }
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**ï¼š åˆ é™¤å‘˜å·¥åŠŸèƒ½

## æ–°å¢å‘˜å·¥åŠŸèƒ½-å¼¹å±‚-æ ¡éªŒ-éƒ¨é—¨

**`ç›®æ ‡`**ï¼šå®ç°æ–°å¢å‘˜å·¥çš„åŠŸèƒ½

### æ–°å»ºå‘˜å·¥å¼¹å±‚ç»„ä»¶

> å½“æˆ‘ä»¬ç‚¹å‡»æ–°å¢å‘˜å·¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»ä¼¼çš„å¼¹å±‚

![image-20200917110516195](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200917110516195.png)

ç±»ä¼¼**`ç»„ç»‡æ¶æ„`**çš„ç»„ä»¶ï¼ŒåŒæ ·æ–°å»ºä¸€ä¸ªå¼¹å±‚ç»„ä»¶ **`src/views/employees/components/add-employee.vue`**

```vue
<template>
  <el-dialog title="æ–°å¢å‘˜å·¥" :visible="showDialog">
    <!-- è¡¨å• -->
    <el-form label-width="120px">
      <el-form-item label="å§“å">
        <el-input style="width:50%" placeholder="è¯·è¾“å…¥å§“å" />
      </el-form-item>
      <el-form-item label="æ‰‹æœº">
        <el-input style="width:50%" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" />
      </el-form-item>
      <el-form-item label="å…¥èŒæ—¶é—´">
        <el-date-picker style="width:50%" placeholder="è¯·é€‰æ‹©å…¥èŒæ—¶é—´" />
      </el-form-item>
      <el-form-item label="è˜ç”¨å½¢å¼">
        <el-select style="width:50%" placeholder="è¯·é€‰æ‹©" />
      </el-form-item>
      <el-form-item label="å·¥å·">
        <el-input style="width:50%" placeholder="è¯·è¾“å…¥å·¥å·" />
      </el-form-item>
      <el-form-item label="éƒ¨é—¨">
        <el-input style="width:50%" placeholder="è¯·é€‰æ‹©éƒ¨é—¨" />
      </el-form-item>
      <el-form-item label="è½¬æ­£æ—¶é—´">
        <el-date-picker style="width:50%" placeholder="è¯·é€‰æ‹©è½¬æ­£æ—¶é—´" />
      </el-form-item>
    </el-form>
    <!-- footeræ’æ§½ -->
    <template v-slot:footer>
      <el-row type="flex" justify="center">
        <el-col :span="6">
          <el-button size="small">å–æ¶ˆ</el-button>
          <el-button type="primary" size="small">ç¡®å®š</el-button>
        </el-col>
      </el-row>
    </template>
  </el-dialog>
</template>

<script>
export default {
  props: {
    showDialog: {
      type: Boolean,
      default: false
    }
  }
}
</script>

<style>

</style>

```

### å¼•ç”¨å¼¹å‡ºå±‚ï¼Œç‚¹å‡»å¼¹å‡º

çˆ¶ç»„ä»¶ä¸­å¼•ç”¨ï¼Œå¼¹å‡ºå±‚

```vue
import AddDemployee from './components/add-employee'
<!-- æ”¾ç½®æ–°å¢ç»„ä»¶ -->
 <add-employee :show-dialog.sync="showDialog" />

```



```vue
<!-- æ”¾ç½®æ–°å¢ç»„ä»¶ -->
 <add-employee :show-dialog.sync="showDialog" />

 <el-button icon="plus" type="primary" size="small" @click="showDialog = true">æ–°å¢å‘˜å·¥</el-button>

```

### æ–°å¢å‘˜å·¥çš„è¡¨å•æ ¡éªŒ

**å°è£…æ–°å¢å‘˜å·¥**api **`src/api/employees.js`**

```js
/** **
 *  æ–°å¢å‘˜å·¥çš„æ¥å£
 * **/
export function addEmployee(data) {
  return request({
    method: 'post',
    url: '/sys/user',
    data
  })
}

```

é’ˆå¯¹å‘˜å·¥å±æ€§ï¼Œæ·»åŠ æ ¡éªŒè§„åˆ™

```js
import EmployeeEnum from '@/api/constant/employees'

  data() {
    return {
      // ---------->æš‚æ—¶ä¸éœ€è¦æ·»åŠ è¿™äº›æ•°æ®ï¼Œå®Œæˆéƒ¨é—¨æ ‘å½¢ç»„ä»¶çš„æ—¶å€™å†å»æ·»åŠ 
      EmployeeEnum, // åœ¨dataä¸­å®šä¹‰æ•°æ®
      // è¡¨å•æ•°æ®
      treeData: [], // å®šä¹‰æ•°ç»„æ¥æ”¶æ ‘å½¢æ•°æ®
      showTree: false, // æ§åˆ¶æ ‘å½¢çš„æ˜¾ç¤ºæˆ–è€…éšè—
      loading: false, // æ§åˆ¶æ ‘çš„æ˜¾ç¤ºæˆ–è€…éšè—è¿›åº¦æ¡
      
      // <------ ending
      formData: {
        username: '',// ç”¨æˆ·å§“å
        mobile: '', // æ‰‹æœºå·
        formOfEmployment: '', // è˜ç”¨å½¢å¼
        workNumber: '', // å·¥å·
        departmentName: '', // éƒ¨é—¨åç§°
        timeOfEntry: '', // å…¥èŒæ—¶é—´
        correctionTime: '' // è½¬æ­£æ—¶é—´
      },
      rules: {
        username: [{ required: true, message: 'ç”¨æˆ·å§“åä¸èƒ½ä¸ºç©º', trigger: 'blur' }, {
          min: 1, max: 4, message: 'ç”¨æˆ·å§“åä¸º1-4ä½'
        }],
        mobile: [{ required: true, message: 'æ‰‹æœºå·ä¸èƒ½ä¸ºç©º', trigger: 'blur' }, {
          pattern: /^1[3-9]\d{9}$/, message: 'æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®', trigger: 'blur'
        }],
        formOfEmployment: [{ required: true, message: 'è˜ç”¨å½¢å¼ä¸èƒ½ä¸ºç©º', trigger: 'blur' }],
        workNumber: [{ required: true, message: 'å·¥å·ä¸èƒ½ä¸ºç©º', trigger: 'blur' }],
        departmentName: [{ required: true, message: 'éƒ¨é—¨ä¸èƒ½ä¸ºç©º', trigger: 'change' }],
        timeOfEntry: [{ required: true, message: 'å…¥èŒæ—¶é—´', trigger: 'blur' }]
      }
    }
  }
```

ç»‘å®šæ•°æ®å’Œè§„åˆ™æ ¡éªŒ

```vue
    <el-form :model="formData" :rules="rules" label-width="120px">
      <el-form-item label="å§“å" prop="username">
        <el-input v-model="formData.username" style="width:50%" placeholder="è¯·è¾“å…¥å§“å" />
      </el-form-item>
      <el-form-item label="æ‰‹æœº" prop="mobile">
        <el-input v-model="formData.mobile" style="width:50%" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" />
      </el-form-item>
      <el-form-item label="å…¥èŒæ—¶é—´" prop="timeOfEntry">
        <el-date-picker v-model="formData.timeOfEntry" style="width:50%" placeholder="è¯·é€‰æ‹©æ—¥æœŸ" />
      </el-form-item>
      <el-form-item label="è˜ç”¨å½¢å¼" prop="formOfEmployment">
        <el-select v-model="formData.formOfEmployment" style="width:50%" placeholder="è¯·é€‰æ‹©" />
      </el-form-item>
      <el-form-item label="å·¥å·" prop="workNumber">
        <el-input v-model="formData.workNumber" style="width:50%" placeholder="è¯·è¾“å…¥å·¥å·" />
      </el-form-item>
      <el-form-item label="éƒ¨é—¨" prop="departmentName">
        <el-input v-model="formData.departmentName" style="width:50%" placeholder="è¯·é€‰æ‹©éƒ¨é—¨" />
      </el-form-item>
      <el-form-item label="è½¬æ­£æ—¶é—´" prop="correctionTime">
        <el-date-picker v-model="formData.correctionTime" style="width:50%" placeholder="è¯·é€‰æ‹©æ—¥æœŸ" />
      </el-form-item>
    </el-form>
```

### åŠ è½½éƒ¨é—¨æ•°æ®è½¬åŒ–æ ‘å½¢

**è˜ç”¨å½¢å¼å’Œé€‰æ‹©éƒ¨é—¨çš„å¤„ç†**

>  å‘˜å·¥çš„éƒ¨é—¨æ˜¯ä»æ ‘å½¢éƒ¨é—¨ä¸­é€‰æ‹©ä¸€ä¸ªéƒ¨é—¨

**è·å–éƒ¨é—¨æ•°æ®ï¼Œè½¬åŒ–æ ‘å½¢**

å®ç°æ€è·¯ï¼š

1. ä½¿ç”¨element-uiçš„çº§è”é€‰æ‹©æ¡†å®ç°



æ­¥éª¤ï¼š

1. æ„å»ºè·å–éƒ¨é—¨æ•°æ®çš„æ–¹æ³•

```js
import { getDepartments } from '@/api/departments'
import { transListToTreeData } from '@/utils'
  data () {
      return {
       treeData: [], // å®šä¹‰æ•°ç»„æ¥æ”¶æ ‘å½¢æ•°æ®
      }
  },
  methods: {
    // ä¸‹æ‹‰æ¡†è·å–åˆ°ç„¦ç‚¹çš„æ—¶å€™å†å»è°ƒç”¨
      async getDepartments() {
        
      if (this.treeData.length) return // å¦‚æœå½“å‰çš„æ ‘å½¢æ•°æ®å·²ç»æœ‰çš„çš„æƒ…å†µä¸‹å°±ä¸éœ€è¦å†è·å–æ•°æ®
      const { depts } = await getDepartments()
      // deptsæ˜¯æ•°ç»„ ä½†ä¸æ˜¯æ ‘å½¢
      this.treeData = transListToTreeData(depts, '')
    },
  }
```

2. æ„å»ºçº§è”é€‰æ‹©å™¨

   :::tip propså±æ€§ä»‹ç»

    checkStrictly: true ==> æ˜¯å¦è®©çˆ¶å­ä¸è”åŠ¨

    label: 'name' ==> æ ‘å½¢ç»“æ„å±•ç¤ºçš„åç§°

    value: 'name' ==> é€‰ä¸­æŸä¸€é¡¹ä¹‹åï¼ŒçœŸæ­£æäº¤çš„æ•°æ®

    emitPath: false ==> æ˜¯å¦æ‹¿åˆ°åµŒå¥—èŠ‚ç‚¹çš„æ‰€æœ‰æ•°æ®(æˆ‘ä»¬åªéœ€è¦å½“å‰èŠ‚ç‚¹çš„nameå€¼å³å¯)

   :::

   ```html
        <el-form-item label="éƒ¨é—¨" prop="departmentName">
           <!--        <el-input v-model="formData.departmentName" style="width:50%" placeholder="è¯·é€‰æ‹©éƒ¨é—¨" />-->
           <el-cascader
             v-model="formData.departmentName"
             style="width: 50%;"
             :options="treeData" // çº§è”é€‰æ‹©æ¡†çš„å±æ€§ç»“æ„æ•°æ®
             :props="{ checkStrictly: true, label: 'name', value: 'name', emitPath: false }"
             clearable // æ˜¯å¦å±•ç¤ºæ¸…é™¤çš„å°â
             placeholder="è¯·é€‰æ‹©éƒ¨é—¨æ•°æ®"
             @focus="getDepartments" // è·å–ç„¦ç‚¹çš„æ—¶å€™å†å»è·å–éƒ¨é—¨æ•°æ®
           />
         </el-form-item>
   ```

   



**è˜ç”¨å½¢å¼**

å®ç°æ€è·¯ï¼šæ•°æ®æ˜¯å†™æ­»çš„æ•°æ®ï¼Œç›´æ¥ä»æœ¬åœ°è·å–æ–‡ä»¶å³å¯: ä½¿ç”¨ä¹‹å‰éœ€è¦å¯¼å…¥è‡ªå·±çš„æœ¬åœ°æ•°æ®,æ¸²æŸ“åˆ°ä¸‹æ‹‰æ¡†å³å¯

```js
import EmployeeEnum from '@/api/constant/employees'
```



```vue
    <el-form-item label="è˜ç”¨å½¢å¼" prop="formOfEmployment">
        <el-select v-model="formData.formOfEmployment" style="width:50%" placeholder="è¯·é€‰æ‹©">
          <!-- éå†åªèƒ½éå†ç»„ä»¶çš„æ•°æ® -->
          <el-option v-for="item in EmployeeEnum.hireType" :key="item.id" :label="item.value" :value="item.id" />
        </el-select>
      </el-form-item>
```



## æ–°å¢å‘˜å·¥åŠŸèƒ½-ç¡®å®š-å–æ¶ˆ

**è°ƒç”¨æ–°å¢æ¥å£**

```js
    // ç‚¹å‡»ç¡®å®šæ—¶ æ ¡éªŒæ•´ä¸ªè¡¨å•
    async btnOK() {
      try {
        await this.$refs.addEmployee.validate()
        // è°ƒç”¨æ–°å¢æ¥å£
        await addEmployee(this.formData) // æ–°å¢å‘˜å·¥
        // å‘Šè¯‰çˆ¶ç»„ä»¶æ›´æ–°æ•°æ®
        // this.$parent å¯ä»¥ç›´æ¥è°ƒç”¨åˆ°çˆ¶ç»„ä»¶çš„å®ä¾‹ å®é™…ä¸Šå°±æ˜¯çˆ¶ç»„ä»¶this
        // this.$emit
        this.$parent.getEmployeeList()
        this.$parent.showDialog = false
      } catch (error) {
        console.log(error)
      }
    },
    btnCancel() {
      // é‡ç½®åŸæ¥çš„æ•°æ®
      this.formData = {
        username: '',
        mobile: '',
        formOfEmployment: '',
        workNumber: '',
        departmentName: '',
        timeOfEntry: '',
        correctionTime: ''
      }
      this.$refs.addEmployee.resetFields() // é‡ç½®æ ¡éªŒç»“æœ
      this.$emit('update:showDialog', false)
    }
```

> æ–°å¢å‘˜å·¥çš„åŠŸèƒ½å’Œç»„ç»‡æ¶æ„çš„åŠŸèƒ½æå…¶ç±»ä¼¼ï¼Œè¿™é‡Œä¸åšè¿‡å¤šé˜è¿°

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`** æ–°å¢å‘˜å·¥åŠŸèƒ½å’Œå¼¹å±‚

## å‘˜å·¥å¯¼å…¥ç»„ä»¶å°è£…

**`ç›®æ ‡`**ï¼šå°è£…ä¸€ä¸ªå¯¼å…¥excelæ•°æ®çš„æ–‡ä»¶

![image-20220120163202040](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20220120163202040.png)

é¦–å…ˆå°è£…ä¸€ä¸ªç±»ä¼¼çš„ç»„ä»¶ï¼Œé¦–å…ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç±»ä¼¼åŠŸèƒ½ï¼Œvue-element-adminå·²ç»æä¾›äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹é€ å³å¯ [ä»£ç åœ°å€](https://github.com/PanJiaChen/vue-element-admin/blob/master/src/components/UploadExcel/index.vue)

> ç±»ä¼¼åŠŸèƒ½æ€§çš„ç»„ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¼šä½¿ç”¨å’Œå°è£…å³å¯ 

excelå¯¼å…¥åŠŸèƒ½éœ€è¦ä½¿ç”¨npmåŒ…**`xlsx`**ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…**`xlsx`**æ’ä»¶

```bash
$ npm i xlsx
```

> å°†vue-element-adminæä¾›çš„å¯¼å…¥åŠŸèƒ½æ–°å»ºä¸€ä¸ªç»„ä»¶ï¼Œä½ç½®ï¼š **`src/components/UploadExcel`**

::: tip ç»„ä»¶çš„åˆ›å»ºæ­¥éª¤

1. èµ‹å€¼é›†æˆè§£å†³æ–¹æ¡ˆçš„ä¸Šä¼ ä»£ç 
2. æŠŠç¬”è®°é‡Œé¢**ä¿®æ”¹æ ·å¼å’Œå¸ƒå±€**ä»£ç ä¸­çš„ç»“æ„(template)å’Œæ ·å¼(style)é‡Œé¢çš„ä»£ç å¤åˆ¶è¿‡å»å³å¯

:::

**æ³¨å†Œå…¨å±€çš„å¯¼å…¥excelç»„ä»¶**

```js
import PageTools from './PageTools'
import UploadExcel from './UploadExcel'
export default {
  install(Vue) {
    Vue.component('PageTools', PageTools) // æ³¨å†Œå·¥å…·æ ç»„ä»¶
    Vue.component('UploadExcel', UploadExcel) // æ³¨å†Œå¯¼å…¥excelç»„ä»¶
  }
}
```

**ä¿®æ”¹æ ·å¼å’Œå¸ƒå±€**

```vue
<template>
 <div class="upload-excel">
    <div class="btn-upload">
      <el-button :loading="loading" size="mini" type="primary" @click="handleUpload">
        ç‚¹å‡»ä¸Šä¼ 
      </el-button>
    </div>

    <input ref="excel-upload-input" class="excel-upload-input" type="file" accept=".xlsx, .xls" @change="handleClick">
    <div class="drop" @drop="handleDrop" @dragover="handleDragover" @dragenter="handleDragover">
      <i class="el-icon-upload" />
      <span>å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„</span>
    </div>
  </div>
</template>
<style scoped lang="scss">
.upload-excel {
  display: flex;
  justify-content: center;
   margin-top: 100px;
   .excel-upload-input{
       display: none;
        z-index: -9999;
     }
   .btn-upload , .drop{
      border: 1px dashed #bbb;
      width: 350px;
      height: 160px;
      text-align: center;
      line-height: 160px;
   }
   .drop{
       line-height: 80px;
       color: #bbb;
      i {
        font-size: 60px;
        display: block;
      }
   }
}
</style>
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**ï¼šå‘˜å·¥å¯¼å…¥ç»„ä»¶å°è£…

## å‘˜å·¥çš„å¯¼å…¥

**`ç›®æ ‡`**ï¼šå®ç°å‘˜å·¥çš„å¯¼å…¥

### å»ºç«‹å…¬å…±å¯¼å…¥çš„é¡µé¢è·¯ç”±

**æ–°å»ºä¸€ä¸ªå…¬å…±çš„å¯¼å…¥é¡µé¢ï¼ŒæŒ‚è½½è·¯ç”±** **`src/router/index.js`**

```js
{
    path: '/import',
    component: Layout,
    hidden: true, // éšè—åœ¨å·¦ä¾§èœå•ä¸­
    children: [{
      path: '', // äºŒçº§è·¯ç”±pathä»€ä¹ˆéƒ½ä¸å†™ è¡¨ç¤ºäºŒçº§é»˜è®¤è·¯ç”±
      component: () => import('@/views/import')
    }]
  },
```

**åˆ›å»ºimportè·¯ç”±ç»„ä»¶** **`src/views/import/index.vue`**

```vue
<template>
  <!-- å…¬å…±å¯¼å…¥ç»„ä»¶ --> 
  <upload-excel :on-success="success" />
</template>

```

### åˆ†æexcelå¯¼å…¥ä»£ç ï¼Œå°è£…æ¥å£

> å°è£…å¯¼å…¥å‘˜å·¥çš„apiæ¥å£  

```js
/** *
 *  å°è£…ä¸€ä¸ªå¯¼å…¥å‘˜å·¥çš„æ¥å£
 *
 * ***/

export function importEmployee(data) {
  return request({
    url: '/sys/user/batch',
    method: 'post',
    data
  })
}
```

### å®ç°excelå¯¼å…¥

**è·å–å¯¼å…¥çš„excelæ•°æ®, å¯¼å…¥excelæ¥å£**



::: tip å¤„ç†æ€è·¯



ç›®æ ‡ï¼šæŠŠè·å–åˆ°çš„excelé‡Œé¢æ•°æ®çš„ä¸­æ–‡çš„keyå˜æˆè‹±æ–‡çš„key

1. è·å–çš„resultsä¸ºè¡¨æ ¼é‡Œé¢çš„æ•°æ®
2. å»ºç«‹ä¸€ä¸ªä¸­è‹±æ–‡keyçš„æ˜ å°„è¡¨
3. éå†è·å–åˆ°çš„è¡¨æ ¼é‡Œé¢çš„æ•°æ®ï¼ŒæŠŠä¸­æ–‡çš„keyæ˜ å°„ä¸ºè‹±æ–‡çš„key

:::

```js
    async  success({ header, results }) {
      // å¦‚æœæ˜¯å¯¼å…¥å‘˜å·¥
          const userRelations = {
            'å…¥èŒæ—¥æœŸ': 'timeOfEntry',
            'æ‰‹æœºå·': 'mobile',
            'å§“å': 'username',
            'è½¬æ­£æ—¥æœŸ': 'correctionTime',
            'å·¥å·': 'workNumber'
          }
        const arr = []
       results.forEach(item => {
          const userInfo = {}
          Object.keys(item).forEach(key => {
            userInfo[userRelations[key]] = item[key]
          })
         arr.push(userInfo) 
        })
        await importEmployee(arr) // è°ƒç”¨å¯¼å…¥æ¥å£
        this.$router.back()
    }
```

> ä¸ºäº†è®©è¿™ä¸ªé¡µé¢å¯ä»¥æœåŠ¡æ›´å¤šçš„å¯¼å…¥åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢ä¸­ç”¨å‚æ•°æ¥åˆ¤æ–­ï¼Œæ˜¯å¦æ˜¯å¯¼å…¥å‘˜å·¥

```js
 data() {
    return {
      type: this.$route.query.type
    }
  },
```

å½“excelä¸­æœ‰æ—¥æœŸæ ¼å¼çš„æ—¶å€™ï¼Œå®é™…è½¬åŒ–çš„å€¼ä¸ºä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•è¿›è¡Œè½¬åŒ–

```js
    formatDate(numb, format) {
      const time = new Date((numb - 1) * 24 * 3600000 + 1)
      time.setYear(time.getFullYear() - 70)
      const year = time.getFullYear() + ''
      const month = time.getMonth() + 1 + ''
      const date = time.getDate() - 1 + ''
      if (format && format.length === 1) {
        return year + format + month + format + date
      }
      return year + (month < 10 ? '0' + month : month) + (date < 10 ? '0' + date : date)
    }
```

> éœ€è¦æ³¨æ„ï¼Œ**`å¯¼å…¥çš„æ‰‹æœºå·ä¸èƒ½å’Œä¹‹å‰çš„å­˜åœ¨çš„æ‰‹æœºå·é‡å¤`**

**é€»è¾‘åˆ¤æ–­** 

```js
 async  success({ header, results }) {
      if (this.type === 'user') {
        const userRelations = {
          'å…¥èŒæ—¥æœŸ': 'timeOfEntry',
          'æ‰‹æœºå·': 'mobile',
          'å§“å': 'username',
          'è½¬æ­£æ—¥æœŸ': 'correctionTime',
          'å·¥å·': 'workNumber'
        }
        const arr = []
        // éå†æ‰€æœ‰çš„æ•°ç»„
        results.forEach(item => {
        // éœ€è¦å°†æ¯ä¸€ä¸ªæ¡æ•°æ®é‡Œé¢çš„ä¸­æ–‡éƒ½æ¢æˆè‹±æ–‡
          const userInfo = {}
          Object.keys(item).forEach(key => {
          // keyæ˜¯å½“å‰çš„ä¸­æ–‡å æ‰¾åˆ°å¯¹åº”çš„è‹±æ–‡å
            // è½¬åŒ–æ—¶é—´æ ¼å¼
            if (userRelations[key] === 'timeOfEntry' || userRelations[key] === 'correctionTime') {
              userInfo[userRelations[key]] = new Date(this.formatDate(item[key], '/')) // åªæœ‰è¿™æ ·, æ‰èƒ½å…¥åº“
              return
            }
            userInfo[userRelations[key]] = item[key]
          })
          // æœ€ç»ˆuserInfoå˜æˆäº†å…¨æ˜¯è‹±æ–‡
          arr.push(userInfo)
        })
        await importEmployee(arr)
        this.$message.success('å¯¼å…¥æˆåŠŸ')
      }
      this.$router.back() // å›åˆ°ä¸Šä¸€é¡µ
    },
    // excelä¸­çš„æ—¶é—´æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œéœ€è¦è°ƒç”¨æ­¤æ–¹æ³•è¿›è¡Œå¤„ç† -> ç›´æ¥å¤åˆ¶
    formatDate(numb, format) {
      const time = new Date((numb - 1) * 24 * 3600000 + 1)
      time.setYear(time.getFullYear() - 70)
      const year = time.getFullYear() + ''
      const month = time.getMonth() + 1 + ''
      const date = time.getDate() - 1 + ''
      if (format && format.length === 1) {
        return year + format + month + format + date
      }
      return year + (month < 10 ? '0' + month : month) + (date < 10 ? '0' + date : date)
    }
```

**å‘˜å·¥é¡µé¢è·³è½¬**

```vue
<el-button type="warning" size="small" @click="$router.push('/import?type=user')">å¯¼å…¥</el-button>

```

**`ç›®æ ‡`**ï¼š å®ç°å‘˜å·¥çš„å¯¼å…¥

## å‘˜å·¥å¯¼å‡ºexcelåŠŸèƒ½

**ç›®æ ‡**ï¼š å®ç°å°†å‘˜å·¥æ•°æ®å¯¼å‡ºåŠŸèƒ½

> æ—¥å¸¸ä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°excelå¯¼å‡ºåŠŸèƒ½ï¼Œ æ€ä¹ˆä½¿ç”¨å‘¢

Excel çš„å¯¼å…¥å¯¼å‡ºéƒ½æ˜¯ä¾èµ–äº[js-xlsx](https://github.com/SheetJS/js-xlsx)æ¥å®ç°çš„ã€‚

åœ¨ `js-xlsx`çš„åŸºç¡€ä¸Šåˆå°è£…äº†[Export2Excel.js](https://github.com/PanJiaChen/vue-element-admin/blob/master/src/vendor/Export2Excel.js)æ¥æ–¹ä¾¿å¯¼å‡ºæ•°æ®ã€‚å¤åˆ¶å®˜ç½‘ä»£ç ï¼Œç²˜è´´åˆ°è‡ªå·±é¡¹ç›®vendorsä¸‹é¢



:::warning

æ³¨æ„ï¼šéœ€è¦æŠŠç¬¬ä¸‰æ–¹æ’ä»¶é‡Œé¢çš„å¼•å…¥æ–¹å¼æ”¹å˜ä¸€ä¸‹

å¼•å…¥æ–¹å¼éœ€è¦å˜æˆ

`import * as XLSX from 'xlsx'`

:::

### å®‰è£…excelæ‰€éœ€ä¾èµ–å’ŒæŒ‰éœ€åŠ è½½

ç”±äº `Export2Excel`ä¸ä»…ä¾èµ–`js-xlsx`è¿˜ä¾èµ–`file-saver`å’Œ`script-loader`ã€‚

æ‰€ä»¥ä½ å…ˆéœ€è¦å®‰è£…å¦‚ä¸‹å‘½ä»¤ï¼š

```bash
npm install xlsx file-saver -S
npm install script-loader -S -D
```

ç”±äº`js-xlsx`ä½“ç§¯è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œå¯¼å‡ºåŠŸèƒ½ä¹Ÿä¸æ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™å»ºè®®ä½¿ç”¨æ‡’åŠ è½½ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```js
import('@/vendor/Export2Excel').then(excel => {
  excel.export_json_to_excel({
    header: tHeader, //è¡¨å¤´ å¿…å¡«
    data, // å…·ä½“æ•°æ® å¿…å¡«
    filename: 'excel-list', //éå¿…å¡«
    autoWidth: true, //éå¿…å¡«
    bookType: 'xlsx' //éå¿…å¡«
  })
})
```

### excelå¯¼å‡ºå‚æ•°çš„ä»‹ç»

> vue-element-adminæä¾›äº†å¯¼å‡ºçš„åŠŸèƒ½æ¨¡å—ï¼Œåœ¨è¯¾ç¨‹èµ„æº/excelå¯¼å‡ºç›®å½•ä¸‹ï¼Œæ”¾ç½®åˆ°srcç›®å½•ä¸‹

**å‚æ•°**

| å‚æ•°      | è¯´æ˜                   | ç±»å‹    | å¯é€‰å€¼                                                       | é»˜è®¤å€¼     |
| --------- | ---------------------- | ------- | ------------------------------------------------------------ | ---------- |
| header    | å¯¼å‡ºæ•°æ®çš„è¡¨å¤´         | Array   | /                                                            | []         |
| data      | å¯¼å‡ºçš„å…·ä½“æ•°æ®         | Array   | /                                                            | [[]]       |
| filename  | å¯¼å‡ºæ–‡ä»¶å             | String  | /                                                            | excel-list |
| autoWidth | å•å…ƒæ ¼æ˜¯å¦è¦è‡ªé€‚åº”å®½åº¦ | Boolean | true / false                                                 | true       |
| bookType  | å¯¼å‡ºæ–‡ä»¶ç±»å‹           | String  | xlsx, csv, txt, [more](https://github.com/SheetJS/js-xlsx#supported-output-formats) | xlsx       |

### excelå¯¼å‡ºåŸºæœ¬çš„ç»“æ„

> æˆ‘ä»¬æœ€é‡è¦çš„ä¸€ä»¶äº‹ï¼Œå°±æ˜¯æŠŠè¡¨å¤´å’Œæ•°æ®è¿›è¡Œç›¸åº”çš„å¯¹åº”

å› ä¸ºæ•°æ®ä¸­çš„keyæ˜¯è‹±æ–‡ï¼Œæƒ³è¦å¯¼å‡ºçš„è¡¨å¤´æ˜¯ä¸­æ–‡çš„è¯ï¼Œéœ€è¦å°†ä¸­æ–‡å’Œè‹±æ–‡åšå¯¹åº”

```js
   const headers = {
        'æ‰‹æœºå·': 'mobile',
        'å§“å': 'username',
        'å…¥èŒæ—¥æœŸ': 'timeOfEntry',
        'è˜ç”¨å½¢å¼': 'formOfEmployment',
        'è½¬æ­£æ—¥æœŸ': 'correctionTime',
        'å·¥å·': 'workNumber',
        'éƒ¨é—¨': 'departmentName'
      }
```

ç„¶åï¼Œ**å®Œæˆå¯¼å‡ºä»£ç **

```js
    // å¯¼å‡ºexcelæ•°æ®
    exportData() {
      //  åšæ“ä½œ
      // è¡¨å¤´å¯¹åº”å…³ç³»
      const headers = {
        'å§“å': 'username',
        'æ‰‹æœºå·': 'mobile',
        'å…¥èŒæ—¥æœŸ': 'timeOfEntry',
        'è˜ç”¨å½¢å¼': 'formOfEmployment',
        'è½¬æ­£æ—¥æœŸ': 'correctionTime',
        'å·¥å·': 'workNumber',
        'éƒ¨é—¨': 'departmentName'
      }
      // æ‡’åŠ è½½
      import('@/vendor/Export2Excel').then(async excel => {
        // 1ã€è·å–éœ€è¦å¯¼å‡ºçš„æ•°æ®
        const { rows } = await getEmployeeList({ page: 1, size: this.page.total })
        // 2ã€è°ƒç”¨è‡ªå·±å°è£…çš„æ–¹æ³•è¿›è¡Œæ•°æ®çš„è½¬åŒ–
        const data = this.formatJson(headers, rows)

        excel.export_json_to_excel({
          header: Object.keys(headers), // è¡¨å¤´æ•°ç»„ -> ['å§“å', 'æ‰‹æœºå·', 'å…¥èŒæ—¥æœŸ', 'è˜ç”¨å½¢å¼', ....]
          data, // [['13399999', 'å¼ ä¸‰', '2020-2020-2020', '2020', '79119'],[],[],[],[],[],[]]
          filename: 'å‘˜å·¥ä¿¡æ¯è¡¨',
          autoWidth: true,
          bookType: 'xlsx'
        })
        // è·å–æ‰€æœ‰çš„æ•°æ®

        // excel.export_json_to_excel({
        //   header: ['å§“å', 'è–ªèµ„'],
        //   data: [['å¼ ä¸‰', 12000], ['æå››', 5000]],
        //   filename: 'å‘˜å·¥è–ªèµ„è¡¨',
        //   autoWidth: true,
        //   bookType: 'csv'
        // })
      })
    },
    // è¯¥æ–¹æ³•è´Ÿè´£å°†æ•°ç»„è½¬åŒ–æˆäºŒç»´æ•°ç»„
     fromJson(headers, rows) {
        // rowsçš„ç»“æ„ ->
        // rows: [{username: '234234', mobile: '1398888888', 'workNumber': 123123}, ....]
        // headersçš„ç»“æ„ ['å§“å', 'æ‰‹æœºå·', 'å…¥èŒæ—¥æœŸ', ....] -> é…ç½®é¡¹é‡Œé¢ç”Ÿæ•ˆçš„æ•°æ®ç»“æ„
        // rowsçš„é¢„æœŸç»“æœ -> resultæ•°ç»„çš„æ¯ä¸€é¡¹è¦å’Œå’Œheadersä¸€ä¸€å¯¹åº”
        // result -> [['å¼ ä¸‰', '138888888', '2020-10-01', ...], ['å¼ ä¸‰', '138888888', '2020-10-01', ...]]
        const result = rows.map(item => {
          // item ä¸ºå¯¹è±¡ ->
          // æ›¿æ¢æˆæ•°ç»„å³å¯ ->
          // æ•°ç»„çš„ç»“æ„è¦å’Œheaderså¯¹åº”èµ·æ¥ ->
          return Object.keys(headers).map(key => {
            // key -> ä¸­æ–‡çš„key
            // é¢„æœŸ -> è¿”å›å½“å‰é¡¹çš„å€¼
            // å€¼åœ¨å“ªï¼Ÿ-> itemä¸ºçœŸå®çš„æ•°æ®å¯¹è±¡ -> å–åˆ°æ­£ç¡®çš„å€¼è¿”å›å³å¯

            // è¿”å›å€¼çš„æ€è·¯
            // 1. æ•°æ®é‡Œé¢çš„keyæ˜¯ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ï¼Ÿ -> è‹±æ–‡
            // 2. headersé‡Œé¢å–åˆ°ä¸­æ–‡keyå¯¹åº”çš„è‹±æ–‡key
            // 3. ç›´æ¥å»æ•°æ®å¯¹è±¡é‡Œé¢å–æ•°æ®
            return item[headers[key]]
          })
        })
        return result
      }
```

::: tip å¼€å§‹åˆ¤æ–­æ—¶é—´æ ¼å¼ä»¥åŠè˜ç”¨å½¢å¼

```js{7-14}

import { formatDate } from '@/filters'

fromJson(headers, rows) {
  const result = rows.map(item => {
    return Object.keys(headers).map(key => {
      if (headers[key] === 'timeOfEntry' || headers[key] === 'correctionTime') {
        // æ ¼å¼åŒ–æ—¥æœŸ -> å·²ç»å®šä¹‰è¿‡è¿‡æ»¤å™¨ç›´æ¥ä½¿ç”¨å³å¯
        return formatDate(item[headers[key]])
      } else if (headers[key] === 'formOfEmployment') {
        // éœ€è¦å¼•å…¥EmployeeEnumå¸¸é‡è¿›è¡Œå¤„ç†
        const obj = EmployeeEnum.hireType.find(obj => obj.id === item[headers[key]])
        return obj ? obj.value : 'æœªçŸ¥'
      }
      return item[headers[key]]
    })
  })
  return result
}
```

:::

### 





### **æ‰©å±•**  å¤æ‚è¡¨å¤´çš„å¯¼å‡º

> å½“éœ€è¦å¯¼å‡ºå¤æ‚è¡¨å¤´çš„æ—¶å€™ï¼Œvue-element-adminåŒæ ·æ”¯æŒè¯¥ç±»æ“ä½œ

**vue-element-admin** æä¾›çš„å¯¼å‡ºæ–¹æ³•ä¸­æœ‰ **multiHeader**å’Œ**merges** çš„å‚æ•°

| å‚æ•°        | è¯´æ˜           | ç±»å‹  | å¯é€‰å€¼ | é»˜è®¤å€¼ |
| ----------- | -------------- | ----- | ------ | ------ |
| multiHeader | å¤æ‚è¡¨å¤´çš„éƒ¨åˆ† | Array | /      | [[]]   |
| merges      | éœ€è¦åˆå¹¶çš„éƒ¨åˆ† | Array | /      | []     |

multiHeaderé‡Œé¢æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œé‡Œé¢çš„ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€è¡Œè¡¨å¤´ï¼Œå‡è®¾ä½ æƒ³å¾—åˆ°ä¸€ä¸ªå¦‚å›¾çš„ç»“æ„

![image-20211027183757251](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20211027183757251.png)

mutiHeaderåº”è¯¥è¿™æ ·å®šä¹‰

```js
const multiHeader = [['å§“å', 'ä¸»è¦ä¿¡æ¯', '', '', '', '', 'éƒ¨é—¨']]
```

multiHeaderä¸­çš„ä¸€è¡Œè¡¨å¤´ä¸­çš„å­—æ®µçš„ä¸ªæ•°éœ€è¦å’ŒçœŸæ­£çš„åˆ—æ•°ç›¸ç­‰ï¼Œå‡è®¾æƒ³è¦è·¨åˆ—ï¼Œå¤šä½™çš„ç©ºé—´éœ€è¦å®šä¹‰æˆç©ºä¸²

å®ƒä¸»è¦å¯¹åº”çš„æ˜¯æ ‡å‡†çš„è¡¨å¤´

```js
const header = ['å§“å', 'æ‰‹æœºå·', 'å…¥èŒæ—¥æœŸ', 'è˜ç”¨å½¢å¼', 'è½¬æ­£æ—¥æœŸ', 'å·¥å·', 'éƒ¨é—¨']
```

å¦‚æœï¼Œæˆ‘ä»¬è¦å®ç°å…¶åˆå¹¶çš„æ•ˆæœï¼Œ éœ€è¦è®¾å®šmergesé€‰é¡¹

```js
 const merges = ['A1:A2', 'B1:F1', 'G1:G2']
```

mergesçš„é¡ºåºæ˜¯æ²¡å…³ç³»çš„ï¼Œåªè¦é…ç½®è¿™ä¸¤ä¸ªå±æ€§ï¼Œå°±å¯ä»¥å¯¼å‡ºå¤æ‚è¡¨å¤´çš„exceläº†

```js
  exportData() {
      const headers = {
        'å§“å': 'username',
        'æ‰‹æœºå·': 'mobile',
        'å…¥èŒæ—¥æœŸ': 'timeOfEntry',
        'è˜ç”¨å½¢å¼': 'formOfEmployment',
        'è½¬æ­£æ—¥æœŸ': 'correctionTime',
        'å·¥å·': 'workNumber',
        'éƒ¨é—¨': 'departmentName'
      }
      // å¯¼å‡ºexcel
      import('@/vendor/Export2Excel').then(async excel => {
        //  excelæ˜¯å¼•å…¥æ–‡ä»¶çš„å¯¼å‡ºå¯¹è±¡
        // å¯¼å‡º  headerä»å“ªé‡Œæ¥
        // dataä»å“ªé‡Œæ¥
        // ç°åœ¨æ²¡æœ‰ä¸€ä¸ªæ¥å£è·å–æ‰€æœ‰çš„æ•°æ®
        // è·å–å‘˜å·¥çš„æ¥å£ é¡µç  æ¯é¡µæ¡æ•°    100   1 10000
        const { rows } = await getEmployeeList({ page: 1, size: this.page.total })
        const data = this.formatJson(headers, rows) // è¿”å›çš„dataå°±æ˜¯ è¦å¯¼å‡ºçš„ç»“æ„
        const multiHeader = [['å§“å', 'ä¸»è¦ä¿¡æ¯', '', '', '', '', 'éƒ¨é—¨']]
        const merges = ['A1:A2', 'B1:F1', 'G1:G2']
        excel.export_json_to_excel({
          header: Object.keys(headers),
          data,
          filename: 'å‘˜å·¥èµ„æ–™è¡¨',
          multiHeader, // å¤æ‚è¡¨å¤´
          merges // åˆå¹¶é€‰é¡¹
        })

        // excel.export_json_to_excel({
        //   header: ['å§“å', 'å·¥èµ„'],
        //   data: [['å¼ ä¸‰', 3000], ['æå››', 5000]],
        //   filename: 'å‘˜å·¥å·¥èµ„è¡¨'
        // })
        // [{ username: 'å¼ ä¸‰',mobile: 13112345678 }]  => [[]]
        // è¦è½¬åŒ– æ•°æ®ç»“æ„ è¿˜è¦å’Œè¡¨å¤´çš„é¡ºåºå¯¹åº”ä¸Š
        // è¦æ±‚è½¬å‡ºçš„æ ‡é¢˜æ˜¯ä¸­æ–‡
      })
    },
    // å°†è¡¨å¤´æ•°æ®å’Œæ•°æ®è¿›è¡Œå¯¹åº”
    // [{}]  =>   [[]]
    formatJson(headers, rows) {
      return rows.map(item => {
        // itemæ˜¯ä¸€ä¸ªå¯¹è±¡  { mobile: 132111,username: 'å¼ ä¸‰'  }
        // ["æ‰‹æœºå·", "å§“å", "å…¥èŒæ—¥æœŸ" ã€‚ã€‚]
        return Object.keys(headers).map(key => {
          // éœ€è¦åˆ¤æ–­ å­—æ®µ
          if (headers[key] === 'timeOfEntry' || headers[key] === 'correctionTime') {
            // æ ¼å¼åŒ–æ—¥æœŸ
            return formatDate(item[headers[key]])
          } else if (headers[key] === 'formOfEmployment') {
            const obj = EmployeeEnum.hireType.find(obj => obj.id === item[headers[key]])
            return obj ? obj.value : 'æœªçŸ¥'
          }
          return item[headers[key]]
        })
        // ["132", 'å¼ ä¸‰â€™ï¼Œ â€˜â€™ï¼Œâ€˜â€™ï¼Œâ€˜â€™d]
      })
      // return rows.map(item => Object.keys(headers).map(key => item[headers[key]]))
      // éœ€è¦å¤„ç†æ—¶é—´æ ¼å¼é—®é¢˜
    }
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**å®ç°å°†å‘˜å·¥æ•°æ®å¯¼å‡ºåŠŸèƒ½

## å‘˜å·¥è¯¦æƒ…é¡µåˆ›å»ºå’Œå¸ƒå±€

**`ç›®æ ‡`**ï¼šåˆ›å»ºå‘˜å·¥è¯¦æƒ…çš„ä¸»è¦å¸ƒå±€é¡µé¢å’ŒåŸºæœ¬å¸ƒå±€

### è¯¦æƒ…é¡µçš„åŸºæœ¬å¸ƒå±€å’Œè·¯ç”±

![image-20200726130305221](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200726130305221.png)

**å»ºç«‹è¯¦æƒ…é¡µè·¯ç”±**

```js
{
    path: 'detail/:id', // queryä¼ å‚ åŠ¨æ€è·¯ç”±ä¼ å‚
    component: () => import('@/views/employees/detail'),
    hidden: true, // ä¸åœ¨å·¦ä¾§èœå•æ˜¾ç¤º
    meta: {
      title: 'å‘˜å·¥è¯¦æƒ…' // æ ‡è®°å½“å‰è·¯ç”±è§„åˆ™çš„ä¸­æ–‡åç§° åç»­åœ¨åšå·¦ä¾§èœå•æ—¶ ä½¿ç”¨
    }
  }
```

**å»ºç«‹åŸºæœ¬æ¶æ„**

```vue
<div class="dashboard-container">
    <div class="app-container">
      <el-card>
        <el-tabs>
          <el-tab-pane label="ç™»å½•è´¦æˆ·è®¾ç½®">
            <!-- æ”¾ç½®è¡¨å• -->
            <el-form label-width="120px" style="margin-left: 120px; margin-top:30px">
              <el-form-item label="å§“å:">
                <el-input style="width:300px" />
              </el-form-item>
              <el-form-item label="å¯†ç :">
                <el-input style="width:300px" type="password" />
              </el-form-item>
              <el-form-item>
                <el-button type="primary">æ›´æ–°</el-button>
              </el-form-item>
            </el-form>
          </el-tab-pane>
          <el-tab-pane label="ä¸ªäººè¯¦æƒ…" />
          <el-tab-pane label="å²—ä½ä¿¡æ¯" />
        </el-tabs>
      </el-card>
    </div>
  </div>
```

**åˆ—è¡¨è·³è½¬åˆ°è¯¦æƒ…*

```vue
<el-button type="text" size="small" @click="$router.push(`/employees/detail/${obj.row.id}`)">æŸ¥çœ‹</el-button>

```

### è¯»å–å’Œä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„æ¥å£

**åŠ è½½ä¸ªäººåŸºæœ¬ä¿¡æ¯** > è¯¥æ¥å£å·²ç»åœ¨ä¹‹å‰æä¾›è¿‡äº† **`src/api/user.js`**

```js
/** *
 *  è·å–æŸä¸ªç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯
 *
 * ***/
export function getUserDetailById(id) {
  return request({
    url: `/sys/user/${id}`
  })
}

```

**ä¿å­˜ä¸ªäººåŸºæœ¬ä¿¡æ¯**  **`src/api/employees.js`**

```js
/** *
 *
 * ä¿å­˜å‘˜å·¥çš„åŸºæœ¬ä¿¡æ¯
 * **/
export function saveUserDetailById(data) {
  return request({
    url: `/sys/user/${data.id}`,
    method: 'put',
    data
  })
}

```

### å®ç°ç”¨æˆ·åå’Œå¯†ç çš„ä¿®æ”¹

**`æ³¨æ„`**ï¼šè¿™é‡Œæœ‰ä¸ªç¼ºé™·ï¼Œæ¥å£ä¸­è¯»å–çš„æ˜¯åç«¯çš„å¯†æ–‡ passwordï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½è§£å¯†ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æ²¡æœ‰ä»»ä½•ä¿®æ”¹å°±ä¿å­˜æ—¶ï¼Œä¼šæ ¡éªŒå¤±è´¥ï¼Œå› ä¸ºå¯†æ–‡è¶…è¿‡äº†è§„å®šçš„12ä½é•¿åº¦ï¼Œä¸ºäº†çœŸçš„ä¿®æ”¹å¯†ç ï¼Œæˆ‘ä»¬è®¾å®šäº†ä¸€ä¸ªä¸´æ—¶çš„å­—æ®µ **password2**ï¼Œç”¨å®ƒæ¥å­˜å‚¨æˆ‘ä»¬çš„ä¿®æ”¹å€¼ï¼Œæœ€åä¿å­˜çš„æ—¶å€™ï¼ŒæŠŠ**password2**ä¼ ç»™**password**

**ç”¨æˆ·åå’Œå¯†ç çš„ä¿®æ”¹**  **`src/views/employees/detail.vue`**

```js
import { getUserDetailById } from '@/api/user'
import { saveUserDetailById } from '@/api/employees'
export default {
  data() {
    return {
      userId: this.$route.params.id, // è¿™æ ·å¯ä»¥åé¢ç›´æ¥é€šè¿‡ this.userIdè¿›è¡Œè·å–æ•°æ®
      userInfo: {
        // ä¸“é—¨å­˜æ”¾åŸºæœ¬ä¿¡æ¯
        username: '',
        password2: ''
      },
      rules: {
        username: [{ required: true, message: 'å§“åä¸èƒ½ä¸ºç©º', trigger: 'blur' }],
        password2: [{ required: true, message: 'å¯†ç ä¸èƒ½ä¸ºç©º', trigger: 'blur' },
          { min: 6, max: 9, message: 'å¯†ç é•¿åº¦6-9ä½', trigger: 'blur' }]
      }
    }
  },
  created() {
    this.getUserDetailById()
  },
  methods: {
    async getUserDetailById() {
      this.userInfo = await getUserDetailById(this.userId)
    },
    async saveUser() {
      try {
        // æ ¡éªŒ
        await this.$refs.userForm.validate()
        await saveUserDetailById({ ...this.userInfo, password: this.userInfo.password2 }) // å°†æ–°å¯†ç çš„å€¼æ›¿æ¢åŸå¯†ç çš„å€¼
        this.$message.success('ä¿å­˜æˆåŠŸ')
      } catch (error) {
        console.log(error)
      }
    }
  }
}
```

**ç»‘å®šè¡¨å•æ•°æ®**

```vue
 <!-- æ”¾ç½®è¡¨å• -->
            <el-form ref="userForm" :model="userInfo" :rules="rules" label-width="120px" style="margin-left: 120px; margin-top:30px">
              <el-form-item label="å§“å:" prop="username">
                <el-input v-model="userInfo.username" style="width:300px" />
              </el-form-item>
              <el-form-item label="æ–°å¯†ç :" prop="password2">
                <el-input v-model="userInfo.password2" style="width:300px" type="password" />
              </el-form-item>
              <el-form-item>
                <el-button type="primary" @click="saveUser">æ›´æ–°</el-button>
              </el-form-item>
            </el-form>
```

**æäº¤ä»£ç **



## ä¸ªäººç»„ä»¶å’Œå²—ä½ç»„ä»¶å°è£…

### å°è£…ä¸ªäººè¯¦æƒ…ç»„ä»¶

> æˆ‘ä»¬å°†å‘˜å·¥ä¸ªäººä¿¡æ¯åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œè´¦æˆ·ï¼Œä¸ªäººï¼Œ å²—ä½ï¼Œè¿™ä¸ªå°èŠ‚æˆ‘ä»¬å¯¹ä¸ªäººç»„ä»¶å’Œå²—ä½ç»„ä»¶è¿›è¡Œå°è£…

![image-20200901105323305](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200901105323305.png)

**å°è£…ä¸ªäººç»„ä»¶**   **`src/views/employees/components/user-info.vue`**

```vue
<template>
  <div class="user-info">
    <!-- ä¸ªäººä¿¡æ¯ -->
    <el-form label-width="220px">
      <!-- å·¥å· å…¥èŒæ—¶é—´ -->
      <el-row class="inline-info">
        <el-col :span="12">
          <el-form-item label="å·¥å·">
            <el-input v-model="userInfo.workNumber" class="inputW" />
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="å…¥èŒæ—¶é—´">
            <el-date-picker
              v-model="userInfo.timeOfEntry"
              type="date"
              class="inputW"
              value-format="YYYY-MM-DD"
            />
          </el-form-item>
        </el-col>
      </el-row>
      <!-- å§“å éƒ¨é—¨ -->
      <el-row class="inline-info">
        <el-col :span="12">
          <el-form-item label="å§“å">
            <el-input v-model="userInfo.username" class="inputW" />
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="éƒ¨é—¨">
            <el-input v-model="userInfo.departmentName" class="inputW" />
          </el-form-item>
        </el-col>
      </el-row>
      <!--æ‰‹æœº è˜ç”¨å½¢å¼  -->
      <el-row class="inline-info">
        <el-col :span="12">
          <el-form-item label="æ‰‹æœº">
            <el-input v-model="userInfo.mobile" />
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="è˜ç”¨å½¢å¼">
            <el-select v-model="userInfo.formOfEmployment" class="inputW">
              <el-option
                v-for="item in EmployeeEnum.hireType"
                :key="item.id"
                :label="item.value"
                :value="item.id"
              />
            </el-select>
          </el-form-item>
        </el-col>
      </el-row>
      <!-- å‘˜å·¥ç…§ç‰‡ -->
      <el-row class="inline-info">
        <el-col :span="12">
          <el-form-item label="å‘˜å·¥å¤´åƒ">
            <!-- æ”¾ç½®ä¸Šä¼ å›¾ç‰‡ -->
           
          </el-form-item>
        </el-col>
      </el-row>
      <!-- ä¿å­˜ä¸ªäººä¿¡æ¯ -->
      <el-row class="inline-info" type="flex" justify="center">
        <el-col :span="12">
          <el-button type="primary" @click="saveUser">ä¿å­˜æ›´æ–°</el-button>
          <el-button @click="$router.back()">è¿”å›</el-button>

        </el-col>
      </el-row>
    </el-form>
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <el-form label-width="220px">
      <div class="block">
        <div class="title">åŸºç¡€ä¿¡æ¯</div>
        <el-form-item label="æœ€é«˜å­¦å†">
          <el-select v-model="formData.theHighestDegreeOfEducation" class="inputW2">
            <el-option
              v-for="item in EmployeeEnum.highestDegree"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <!-- ä¸ªäººå¤´åƒ -->
        <!-- å‘˜å·¥ç…§ç‰‡ -->

        <el-form-item label="å‘˜å·¥ç…§ç‰‡">
          <!-- æ”¾ç½®ä¸Šä¼ å›¾ç‰‡ -->
        </el-form-item>
        <el-form-item label="å›½å®¶/åœ°åŒº">
          <el-select v-model="formData.nationalArea" class="inputW2">
            <el-option
              v-for="item in EmployeeEnum.isOverseas"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="æŠ¤ç…§å·">
          <el-input v-model="formData.passportNo" placeholder="æ­£è§„æŠ¤ç…§æ ¼å¼" class="inputW" />
        </el-form-item>
        <el-form-item label="èº«ä»½è¯å·">
          <el-input v-model="formData.idNumber" placeholder="æ­£è§„èº«ä»½è¯æ ¼å¼" class="inputW" />
        </el-form-item>
        <el-form-item label="ç±è´¯">
          <el-input v-model="formData.nativePlace" placeholder="ç±è´¯åœ°å€" class="inputW5" />
        </el-form-item>
        <el-form-item label="æ°‘æ—">
          <el-input v-model="formData.nation" placeholder="è¯·è¾“å…¥æ°‘æ—" class="inputW2" />
        </el-form-item>
        <el-form-item label="å©šå§»çŠ¶å†µ">
          <el-select v-model="formData.maritalStatus" class="inputW2">
            <el-option
              v-for="item in EmployeeEnum.maritaStatus"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="ç”Ÿæ—¥">
          <el-input v-model="formData.birthday" placeholder="ç¤ºä¾‹ 0323" class="inputW" />
        </el-form-item>
        <el-form-item label="å¹´é¾„">
          <el-input v-model="formData.age" type="number" class="inputW2" />
        </el-form-item>
        <el-form-item label="æ˜Ÿåº§">
          <el-select v-model="formData.constellation" class="inputW2">
            <el-option
              v-for="item in EmployeeEnum.constellation"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="è¡€å‹">
          <el-select v-model="formData.bloodType" class="inputW2">
            <el-option
              v-for="item in EmployeeEnum.bloodType"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="æˆ·ç±æ‰€åœ¨åœ°">
          <el-input v-model="formData.domicile" class="inputW5" />
        </el-form-item>
        <el-form-item label="æ”¿æ²»é¢è²Œ">
          <el-input v-model="formData.politicalOutlook" class="inputW2" />
        </el-form-item>
        <el-form-item label="å…¥å…šæ—¶é—´">
          <el-date-picker
            v-model="formData.timeToJoinTheParty"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            class="inputW"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="å­˜æ¡£æœºæ„">
          <el-input v-model="formData.archivingOrganization" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
        <el-form-item label="å­å¥³çŠ¶æ€">
          <el-input v-model="formData.stateOfChildren" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
        <el-form-item label="å­å¥³æœ‰æ— å•†ä¸šé™©">
          <el-radio-group v-model="formData.doChildrenHaveCommercialInsurance">
            <el-radio label="1">æœ‰</el-radio>
            <el-radio label="2">æ— </el-radio>
          </el-radio-group>
        </el-form-item>
        <el-form-item label="æœ‰æ— è¿æ³•è¿çºªçŠ¶æ€">
          <el-input v-model="formData.isThereAnyViolationOfLawOrDiscipline" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
        <el-form-item label="æœ‰æ— é‡å¤§ç—…å²">
          <el-input v-model="formData.areThereAnyMajorMedicalHistories" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
      </div>
      <!-- é€šè®¯ä¿¡æ¯ -->
      <div class="block">
        <div class="title">é€šè®¯ä¿¡æ¯</div>
        <el-form-item label="QQ">
          <el-input v-model="formData.qq" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="å¾®ä¿¡">
          <el-input v-model="formData.wechat" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="ç°å±…ä½åœ°">
          <el-input v-model="formData.placeOfResidence" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
        <el-form-item label="é€šè®¯åœ°å€">
          <el-input v-model="formData.postalAddress" placeholder="è¯·è¾“å…¥" />
        </el-form-item>
        <el-form-item label="è”ç³»æ‰‹æœº">
          <el-input v-model="formData.contactTheMobilePhone" placeholder="11ä½å­—ç¬¦" maxlength="11" class="inputW" @change.native="handlePhone(2)" />
        </el-form-item>
        <el-form-item label="ä¸ªäººé‚®ç®±">
          <el-input v-model="formData.personalMailbox" placeholder="è¯·è¾“å…¥" type="mail" class="inputW" />
        </el-form-item>
        <el-form-item label="ç´§æ€¥è”ç³»äºº">
          <el-input v-model="formData.emergencyContact" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="ç´§æ€¥è”ç³»ç”µè¯">
          <el-input v-model="formData.emergencyContactNumber" placeholder="11ä½å­—ç¬¦" class="inputW" />
        </el-form-item>
      </div>
      <!-- è´¦å·ä¿¡æ¯ -->
      <div class="block">
        <div class="title">è´¦å·ä¿¡æ¯</div>
        <el-form-item label="ç¤¾ä¿ç”µè„‘å·">
          <el-input v-model="formData.socialSecurityComputerNumber" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="å…¬ç§¯é‡‘è´¦å·">
          <el-input v-model="formData.providentFundAccount" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="é“¶è¡Œå¡å·">
          <el-input v-model="formData.bankCardNumber" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="å¼€æˆ·è¡Œ">
          <el-input v-model="formData.openingBank" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
      </div>
      <!-- æ•™è‚²ä¿¡æ¯ -->
      <div class="block">
        <div class="title">æ•™è‚²ä¿¡æ¯</div>
        <el-form-item label="å­¦å†ç±»å‹">
          <el-select v-model="formData.educationalType" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in EmployeeEnum.educationType"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="æ¯•ä¸šå­¦æ ¡">
          <el-input v-model="formData.graduateSchool" placeholder="è¯·è¾“å…¥" class="inputW2" />
        </el-form-item>
        <el-form-item label="å…¥å­¦æ—¶é—´">
          <el-date-picker v-model="formData.enrolmentTime" type="date" placeholder="è¯·è¾“å…¥æ—¶é—´" class="inputW" value-format="yyyy-MM-dd" />
        </el-form-item>
        <el-form-item label="æ¯•ä¸šæ—¶é—´">
          <el-date-picker v-model="formData.graduationTime" type="date" placeholder="è¯·è¾“å…¥æ—¶é—´" class="inputW" value-format="yyyy-MM-dd" />
        </el-form-item>
        <el-form-item label="ä¸“ä¸š">
          <el-input v-model="formData.major" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
      </div>
      <!-- ä»ä¸šä¿¡æ¯ -->
      <div class="block">
        <div class="title">ä»ä¸šä¿¡æ¯</div>
        <el-form-item label="ä¸Šå®¶å…¬å¸">
          <el-input v-model="formData.homeCompany" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="èŒç§°">
          <el-input v-model="formData.title" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="æœ‰æ— ç«ä¸šé™åˆ¶">
          <el-input v-model="formData.isThereAnyCompetitionRestriction" placeholder="è¯·è¾“å…¥" style="width:80%" />
        </el-form-item>
        <el-form-item label="å¤‡æ³¨">
          <el-input v-model="formData.remarks" type="textarea" placeholder="è¯·è¾“å…¥å¤‡æ³¨" style="width:80%" />
        </el-form-item>
        <!-- ä¿å­˜å‘˜å·¥ä¿¡æ¯ -->
        <el-row class="inline-info" type="flex" justify="center">
          <el-col :span="12">
            <el-button type="primary" @click="savePersonal">ä¿å­˜æ›´æ–°</el-button>
            <el-button @click="$router.back()">è¿”å›</el-button>
          </el-col>
        </el-row>
      </div>
    </el-form>

  </div>

</template>
```

> æœ¬ç« èŠ‚ä¸ªäººæ•°æ®è¿‡äº**`ç¹æ‚ï¼Œåºå¤§`**ï¼ŒåŒå­¦ä»¬åœ¨å¼€å‘æœŸé—´ï¼Œæ‹·è´ä»£ç å³å¯ï¼Œæˆ‘ä»¬åªå†™å…³é”®éƒ¨ä½çš„ä»£ç 

**å®šä¹‰user-infoçš„æ•°æ®**

```js
import EmployeeEnum from '@/api/constant/employees'

export default {
  data() {
    return {
      userId: this.$route.params.id,
      EmployeeEnum, // å‘˜å·¥æšä¸¾æ•°æ®
      userInfo: {},
      formData: {
        userId: '',
        username: '', // ç”¨æˆ·å
        sex: '', // æ€§åˆ«
        mobile: '', // æ‰‹æœº
        companyId: '', // å…¬å¸id
        departmentName: '', // éƒ¨é—¨åç§°
        //  onTheJobStatus: '', // åœ¨èŒçŠ¶æ€ no
        dateOfBirth: '', // å‡ºç”Ÿæ—¥æœŸ
        timeOfEntry: '', // å…¥èŒæ—¶é—´
        theHighestDegreeOfEducation: '', // æœ€é«˜å­¦å†
        nationalArea: '', // å›½å®¶
        passportNo: '', // æŠ¤ç…§å·
        idNumber: '', // èº«ä»½è¯å·
        idCardPhotoPositive: '', // èº«ä»½è¯ç…§æ­£
        idCardPhotoBack: '', // èº«ä»½è¯ç…§æ­£
        nativePlace: '', // ç±è´¯
        nation: '', // æ°‘æ—
        englishName: '', // è‹±æ–‡åå­—
        maritalStatus: '', // å©šå§»çŠ¶å†µ
        staffPhoto: '', // å‘˜å·¥ç…§ç‰‡
        birthday: '', // ç”Ÿæ—¥
        zodiac: '', // å±ç›¸
        age: '', // å¹´é¾„
        constellation: '', // æ˜Ÿåº§
        bloodType: '', // è¡€å‹
        domicile: '', // æˆ·ç±æ‰€åœ¨åœ°
        politicalOutlook: '', // æ”¿æ²»é¢è²Œ
        timeToJoinTheParty: '', // å…¥å…šæ—¶é—´
        archivingOrganization: '', // å­˜æ¡£æœºæ„
        stateOfChildren: '', // å­å¥³çŠ¶æ€
        doChildrenHaveCommercialInsurance: '1', // ä¿é™©çŠ¶æ€
        isThereAnyViolationOfLawOrDiscipline: '', // è¿æ³•è¿çºªçŠ¶æ€
        areThereAnyMajorMedicalHistories: '', // é‡å¤§ç—…å²
        qq: '', // QQ
        wechat: '', // å¾®ä¿¡
        residenceCardCity: '', // å±…ä½è¯åŸå¸‚
        dateOfResidencePermit: '', // å±…ä½è¯åŠç†æ—¥æœŸ
        residencePermitDeadline: '', // å±…ä½è¯æˆªæ­¢æ—¥æœŸ
        placeOfResidence: '', // ç°å±…ä½åœ°
        postalAddress: '', // é€šè®¯åœ°å€
        contactTheMobilePhone: '', // è”ç³»æ‰‹æœº
        personalMailbox: '', // ä¸ªäººé‚®ç®±
        emergencyContact: '', // ç´§æ€¥è”ç³»äºº
        emergencyContactNumber: '', // ç´§æ€¥è”ç³»ç”µè¯
        socialSecurityComputerNumber: '', // ç¤¾ä¿ç”µè„‘å·
        providentFundAccount: '', // å…¬ç§¯é‡‘è´¦å·
        bankCardNumber: '', // é“¶è¡Œå¡å·
        openingBank: '', // å¼€æˆ·è¡Œ
        educationalType: '', // å­¦å†ç±»å‹
        graduateSchool: '', // æ¯•ä¸šå­¦æ ¡
        enrolmentTime: '', // å…¥å­¦æ—¶é—´
        graduationTime: '', // æ¯•ä¸šæ—¶é—´
        major: '', // ä¸“ä¸š
        graduationCertificate: '', // æ¯•ä¸šè¯ä¹¦
        certificateOfAcademicDegree: '', // å­¦ä½è¯ä¹¦
        homeCompany: '', // ä¸Šå®¶å…¬å¸
        title: '', // èŒç§°
        resume: '', // ç®€å†
        isThereAnyCompetitionRestriction: '', // æœ‰æ— ç«ä¸šé™åˆ¶
        proofOfDepartureOfFormerCompany: '', // å‰å…¬å¸ç¦»èŒè¯æ˜
        remarks: '' // å¤‡æ³¨
      }
    }
  }
}
```

**åœ¨detail.vueç»„ä»¶ä¸­ï¼Œæ³¨å†Œå¹¶ä½¿ç”¨**

```vue
 <el-tab-pane label="ä¸ªäººè¯¦æƒ…">
            <!-- æ”¾ç½®ä¸ªäººè¯¦æƒ… -->
            <component :is="userComponent" />
            <!-- <user-info /> -->
  </el-tab-pane>
```

åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åŠ¨æ€ç»„ä»¶**component**ï¼Œå®ƒé€šè¿‡ **`is`**å±æ€§æ¥ç»‘å®šéœ€è¦æ˜¾ç¤ºåœ¨è¯¥ä½ç½®çš„ç»„ä»¶ï¼Œiså±æ€§å¯ä»¥ç›´æ¥ä¸º**`æ³¨å†Œç»„ä»¶`**çš„ç»„ä»¶åç§°å³å¯

é€šè¿‡componentå¯ä»¥å±•ç¤ºä»»ä½•ç»„ä»¶ :is="componentName", ä½¿ç”¨åœºæ™¯ï¼šç»„ä»¶åˆ‡æ¢

### å°è£…å²—ä½ç»„ä»¶

åŒç†ï¼Œå°è£…å²—ä½ç»„ä»¶

**å°è£…å²—ä½ç»„ä»¶**  **`src/views/employee/components/job-info.vue`**

```vue
<template>
<div class="job-info">
    <!-- åŸºç¡€ä¿¡æ¯ -->
    <el-form label-width="220px">
      <div class="block">
        <div class="title">åŸºç¡€ä¿¡æ¯</div>
        <el-form-item label="å²—ä½">
          <el-input v-model="formData.post" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <!-- <el-form-item label="è½¬æ­£æ—¥æœŸ">
          <el-date-picker
            v-model="formData.dateOfCorrection"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item> -->
        <el-form-item label="è½¬æ­£çŠ¶æ€">
          <el-select v-model="formData.stateOfCorrection" placeholder="è¯·é€‰æ‹©" disabled>
            <el-option
              v-for="item in EmployeeEnum.stateOfCorrection"
              :key="item.value"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="èŒçº§">
          <el-input v-model="formData.rank" class="inputW" />
        </el-form-item>
        <el-form-item label="è½¬æ­£è¯„ä»·">
          <el-input v-model="formData.correctionEvaluation" type="textarea" placeholder="1-300ä½å­—ç¬¦" />
        </el-form-item>
        <el-form-item label="æ±‡æŠ¥å¯¹è±¡">
          <el-select v-model="formData.reportId" filterable placeholder="è¯·é€‰æ‹©" class="inputW">
            <el-option v-for="item in depts" :key="item.id" :label="item.username" :value="item.id" />
          </el-select>
        </el-form-item>
        <el-form-item label="HRBP">
          <el-select v-model="formData.hrbp" filterable placeholder="è¯·é€‰æ‹©" class="inputW">
            <el-option v-for="item in depts" :key="item.id" :label="item.username" :value="item.id" class="inputW" />
          </el-select>
        </el-form-item>
        <el-form-item class="formInfo" label="è°ƒæ•´å¸é¾„(å¤©)ï¼š">
          <el-input v-model="formData.adjustmentAgedays" type="number" placeholder="è¯·è¾“å…¥" class="inputW" />
        </el-form-item>
        <el-form-item label="é¦–æ¬¡å‚åŠ å·¥ä½œæ—¶é—´">
          <el-date-picker
            v-model="formData.workingTimeForTheFirstTime"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="è°ƒæ•´å·¥é¾„">
          <el-input v-model="formData.adjustmentOfLengthOfService" placeholder="0.00å¹´" class="inputW" disabled />
        </el-form-item>
      </div>
      <!-- åˆåŒä¿¡æ¯ -->
      <div class="block">
        <div class="title">åˆåŒä¿¡æ¯</div>
        <el-form-item class="formInfo" label="é¦–æ¬¡åˆåŒå¼€å§‹æ—¶é—´ï¼š">
          <el-date-picker
            v-model="formData.initialContractStartTime"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="é¦–æ¬¡åˆåŒç»“æŸæ—¶é—´">
          <el-date-picker
            v-model="formData.firstContractTerminationTime"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="ç°åˆåŒå¼€å§‹æ—¶é—´">
          <el-date-picker
            v-model="formData.currentContractStartTime"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="ç°åˆåŒç»“æŸæ—¶é—´">
          <el-date-picker
            v-model="formData.closingTimeOfCurrentContract	"
            type="date"
            placeholder="é€‰æ‹©æ—¥æœŸ"
            value-format="yyyy-MM-dd"
          />
        </el-form-item>
        <el-form-item label="åˆåŒæœŸé™">
          <el-select v-model="formData.contractPeriod" class="filter-item">
            <el-option
              v-for="item in EmployeeEnum.contractPeriod"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="ç»­ç­¾æ¬¡æ•°">
          <el-select v-model="formData.renewalNumber" class="filter-item">
            <el-option
              v-for="item in EmployeeEnum.renewalCount"
              :key="item.id"
              :label="item.value"
              :value="item.id"
            />
          </el-select>
        </el-form-item>
      </div>
      <!-- æ‹›è˜ä¿¡æ¯ -->
      <div class="block">
        <div class="title">æ‹›è˜ä¿¡æ¯</div>
        <el-form-item label="å…¶ä»–æ‹›è˜æ¸ é“">
          <el-select v-model="formData.otherRecruitmentChannels" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in EmployeeEnum.resumeSource"
              :key="item.id"
              :label="item.value"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="æ‹›è˜æ¸ é“">
          <el-select v-model="formData.recruitmentChannels" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in EmployeeEnum.resumeSource"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="ç¤¾æ‹›/æ ¡æ‹›">
          <el-select v-model="formData.socialRecruitment" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in EmployeeEnum.hireSourceType"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </el-form-item>
        <el-form-item label="æ¨èä¼ä¸š/äºº">
          <el-input v-model="formData.recommenderBusinessPeople" placeholder="è¯·è¾“å…¥" class="infoPosition inputW" />
        </el-form-item>
      </div>
      <!-- ä»ä¸šä¿¡æ¯ -->
      <el-form-item>
        <el-button type="primary" @click="saveJob">ä¿å­˜æ›´æ–°</el-button>
        <el-button @click="$router.back()">è¿”å›</el-button>
      </el-form-item>
    </el-form>
  </div>

</template>
```

**å®šä¹‰å²—ä½æ•°æ®**

```js
import EmployeeEnum from '@/api/constant/employees'

export default {
  data() {
    return {
      userId: this.$route.params.id,
      depts: [],
      EmployeeEnum,
      formData: {
        adjustmentAgedays: '', // è°ƒæ•´å¸é¾„å¤©
        adjustmentOfLengthOfService: '', // è°ƒæ•´å·¥é¾„å¤©
        closingTimeOfCurrentContract: '', // ç°åˆåŒç»“æŸæ—¶é—´
        companyId: '', // å…¬å¸ID
        contractDocuments: '', // åˆåŒæ–‡ä»¶
        contractPeriod: '', // åˆåŒæœŸé™
        correctionEvaluation: '', //  è½¬æ­£è¯„ä»·
        currentContractStartTime: '', // ç°åˆåŒå¼€å§‹æ—¶é—´
        firstContractTerminationTime: '', // é¦–æ¬¡åˆåŒç»“æŸæ—¶é—´
        hrbp: '', // HRBP
        initialContractStartTime: '', // é¦–æ¬¡åˆåŒå¼€å§‹æ—¶é—´
        otherRecruitmentChannels: '', // å…¶ä»–æ‹›è˜æ¸ é“
        post: '', // å²—ä½
        rank: null, // èŒçº§
        recommenderBusinessPeople: '', // æ¨èä¼ä¸šäºº
        recruitmentChannels: '', // æ‹›è˜æ¸ é“
        renewalNumber: '', // ç»­ç­¾æ¬¡æ•°
        reportId: '', // æ±‡æŠ¥å¯¹è±¡
        reportName: null, // æ±‡æŠ¥å¯¹è±¡
        socialRecruitment: '', // ç¤¾æ‹›æ ¡æ‹›
        stateOfCorrection: '', // è½¬æ­£çŠ¶æ€
        taxableCity: '', // çº³ç¨åŸå¸‚
        userId: '', // å‘˜å·¥ID
        workMailbox: '', // å·¥ä½œé‚®ç®±
        workingCity: '', // å·¥ä½œåŸå¸‚
        workingTimeForTheFirstTime: '' // é¦–æ¬¡å‚åŠ å·¥ä½œæ—¶é—´
      }
    }
  }
}
```

**åœ¨detail.vueç»„ä»¶ä¸­ï¼Œæ³¨å†Œå¹¶ä½¿ç”¨**

```vue
 <el-tab-pane label="å²—ä½è¯¦æƒ…">
    <!-- æ”¾ç½®å²—ä½è¯¦æƒ… -->
    <component :is="JobInfo" />
  </el-tab-pane>
```

**`æœ¬èŠ‚ä»»åŠ¡`**ï¼šå®Œæˆä¸ªäººç»„ä»¶å’Œå²—ä½ç»„ä»¶å°è£…

## å‘˜å·¥ä¸ªäººä¿¡æ¯å’Œå²—ä½ä¿¡æ¯-è¯»å–-ä¿å­˜

**`ç›®æ ‡`**ï¼šå®ç°ä¸ªäººä¿¡æ¯çš„å²—ä½ä¿¡æ¯çš„è¯»å–å’Œæ ¡éªŒï¼Œä¿å­˜

### è¯»å–ä¸ªäººä¿å­˜ä¸ªäººä¿¡æ¯

:::tip

æ¥å£çš„å®šä¹‰å’Œè°ƒç”¨ç›´æ¥å¤åˆ¶å³å¯ï¼Œéƒ½æ˜¯å®Œå…¨é‡å¤çš„é€»è¾‘ï¼Œä¸”æœ‰å¤§é‡ä»£ç 



ç”¨æˆ·ä¸ªäººä¿¡æ¯(personal)å’Œå²—ä½ä¿¡æ¯éƒ½å®šä¹‰åœ¨api/employeesä¸‹é¢å³å¯



ç”¨æˆ·åŸºç¡€ä¿¡æ¯(userInfo)æ¥å£åœ¨userInfoä¸­å·²ç»å®šä¹‰å¥½äº†

:::

å°è£… **è¯»å–ä¸ªäººä¿¡æ¯** **ä¿å­˜ä¸ªäººä¿¡æ¯**  **è¯»å–å²—ä½ä¿¡æ¯** **ä¿å­˜å²—ä½ä¿¡æ¯**  

```js
/** *
 *  è¯»å–ç”¨æˆ·è¯¦æƒ…çš„åŸºç¡€ä¿¡æ¯
 * **/
export function getPersonalDetail(id) {
  return request({
    url: `/employees/${id}/personalInfo`
  })
}
/** *
 *  æ›´æ–°ç”¨æˆ·è¯¦æƒ…çš„åŸºç¡€ä¿¡æ¯
 * **/
export function updatePersonal(data) {
  return request({
    url: `/employees/${data.userId}/personalInfo`,
    method: 'put',
    data
  })
}
/** **
 * è·å–ç”¨æˆ·çš„å²—ä½ä¿¡æ¯
 *
 * ****/
export function getJobDetail(id) {
  return request({
    url: `/employees/${id}/jobs`
  })
}
/**
 * ä¿å­˜å²—ä½ä¿¡æ¯
 * ****/
export function updateJob(data) {
  return request({
    url: `/employees/${data.userId}/jobs`,
    method: 'put',
    data
  })
}
```

**è¯»å–ï¼Œä¿å­˜ä¸ªäººä¿¡æ¯**  **`user-info`**  éœ€è¦æ³¨æ„ï¼šè¿™é‡Œçš„ä¿å­˜å®é™…ä¸Šåˆ†æˆäº†ä¸¤ä¸ªæ¥å£ï¼Œè¿™æ˜¯æ¥å£çš„è®¾è®¡ï¼Œæˆ‘ä»¬åªèƒ½éµå®ˆ

::: tip ä¸ŠåŠéƒ¨åˆ†ç”¨æˆ·ä¿¡æ¯æ•°æ®

æ¥å£ï¼šgetUserDetailById

è°ƒç”¨æ–¹æ³•: getUserDetailById

dataé‡Œé¢çš„keyå­—æ®µï¼šuserInfo

å›¾ç‰‡ç±»å‹ï¼šå¤´åƒ

å›¾ç‰‡çš„refï¼šavatarRef

:::

:::tip ä¸‹åŠéƒ¨åˆ†æ•°æ®ä¸ªäººè¯¦ç»†ä¿¡æ¯

æ¥å£ï¼šgetPersonalDetail

è°ƒç”¨æ–¹æ³•: getPersonalDetail

dataé‡Œé¢çš„keyå­—æ®µï¼šformData

å›¾ç‰‡ç±»å‹ï¼šå‘˜å·¥ç…§ç‰‡

å›¾ç‰‡çš„refï¼špersonalRef

:::

```js
import { getPersonalDetail, updatePersonal  } from '@/api/employees'
import { getUserDetailById, saveUserDetailById } from '@/api/user'
 created() {
    this.getPersonalDetail()
    this.getUserDetailById()
  },
  methods: {
    async getPersonalDetail() {
      // è·å–çš„ä¸ºä¸‹åŠéƒ¨åˆ†çš„æ•°æ®
      this.formData = await getPersonalDetail(this.userId) // è·å–å‘˜å·¥æ•°æ®
    },
    async savePersonal() {
      await updatePersonal({ ...this.formData, id: this.userId })
      this.$message.success('ä¿å­˜æˆåŠŸ')
    },
    async saveUser() {
    //  è°ƒç”¨çˆ¶ç»„ä»¶
      await saveUserDetailById(this.userInfo)
      this.$message.success('ä¿å­˜æˆåŠŸ')
    },
    async getUserDetailById() {
      // è·å–ä¸ŠåŠéƒ¨åˆ†æ•°æ®
      this.userInfo = await getUserDetailById(this.userId)
    }
  }
```

### è¯»å–ä¿å­˜å²—ä½ä¿¡æ¯

**è¯»å–ï¼Œä¿å­˜å²—ä½ä¿¡æ¯**  **`job-info`**

```js
  import { getEmployeeSimple, updateJob, getJobDetail } from '@/api/employees'

  created() {
    this.getJobDetail()
    this.getEmployeeSimple()
  },
  methods: {
    async getJobDetail() {
      this.formData = await getJobDetail(this.userId)
    },
    // è·å–å‘˜å·¥åˆ—è¡¨
    async getEmployeeSimple() {
      this.depts = await getEmployeeSimple()
    },
    // ä¿å­˜å²—ä½ä¿¡æ¯
    async saveJob() {
      await updateJob(this.formData)
      this.$message.success('ä¿å­˜å²—ä½ä¿¡æ¯æˆåŠŸ')
    }
  }
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`** å®ç°ä¸ªäººä¿¡æ¯çš„å²—ä½ä¿¡æ¯çš„è¯»å–å’Œæ ¡éªŒï¼Œä¿å­˜

## é…ç½®è…¾è®¯äº‘Cos

**`ç›®æ ‡`**ï¼š é…ç½®ä¸€ä¸ªè…¾è®¯äº‘cos

> ç”±äºä¸Šè¯¾çš„å¼€å‘çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æŠŠæ‰€æœ‰çš„å›¾ç‰‡éƒ½ä¸Šä¼ åˆ°æˆ‘ä»¬è‡ªå·±çš„å®˜æ–¹æœåŠ¡å™¨ä¸Šï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€ä¸ªè…¾è®¯äº‘çš„å›¾ç‰‡æ–¹æ¡ˆ

![image-20200805200831035](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805200831035.png)

> ä¸Šè¾¹å›¾çš„æ„æ€å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸ªå¯ä»¥å…è´¹ä¸Šä¼ å›¾ç‰‡çš„æœåŠ¡å™¨ï¼Œå¸®æˆ‘ä»¬**`ä»£ç®¡å›¾ç‰‡`**ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±çš„æ•°æ®åº“é‡Œåªä¿å­˜ä¸€ä¸ªåœ°å€å°±è¡Œï¼Œ è¿™å…¶å®ä¹Ÿæ˜¯å¾ˆå¤šé¡¹ç›®çš„å¤„ç†æ–¹æ¡ˆï¼Œä¼šæœ‰ä¸€ä¸ª**`å…¬å…±çš„æ–‡ä»¶æœåŠ¡å™¨`**

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆæ‹¥æœ‰ä¸€ä¸ª[è…¾è¿…äº‘](https://cloud.tencent.com/login?s_url=https%3A%2F%2Fconsole.cloud.tencent.com%2F)çš„å¼€å‘è€…è´¦å·(**å°å¿ƒè…¾è®¯äº‘çš„å¹¿å‘Šç”µè¯**)

> è¯·æŒ‰ç…§è…¾è®¯äº‘çš„æ³¨å†Œæ–¹å¼ï¼Œæ³¨å†Œè‡ªå·±çš„è´¦å·

ç¬¬äºŒæ­¥ï¼Œå®åè®¤è¯

> é€‰æ‹©ä¸ªäººè´¦æˆ·

![image-20200805201013078](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201013078.png)

**å¡«å†™ä¸ªäººèº«ä»½ä¿¡æ¯**

![image-20200805201230001](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201230001.png)

ä¸‹ä¸€æ­¥ï¼Œæ‰«æäºŒç»´ç æˆæƒ

![image-20200805201318977](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201318977.png)



**æ‰‹æœºç«¯æˆæƒ**

![image-20200805201422567](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201422567.png)









ç‚¹å‡»**é¢†å–å…è´¹äº§å“**

![image-20200805201513338](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201513338.png)

**é€‰æ‹©å¯¹è±¡å­˜å‚¨COS**

![image-20200805201559233](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201559233.png)

> æˆ‘ä»¬å…è´¹æ‹¥æœ‰**`6ä¸ªæœˆçš„50Gæµé‡`**çš„å¯¹è±¡å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒé™ï¼Œè¶³å¤Ÿæˆ‘ä»¬ä¸Šä¼ ç”¨æˆ·å¤´åƒçš„ä½¿ç”¨äº†

**ç‚¹å‡»0å…ƒè¯•ç”¨ï¼Œå¼€é€šæœåŠ¡**

![image-20200805201750662](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805201750662.png)



åˆ°è¿™ä¸€æ­¥ï¼Œè´¦å·çš„éƒ¨åˆ†å°±æ“ä½œå®Œæ¯•ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ¥åˆ›å»ºä¸€ä¸ªå­˜å‚¨å›¾ç‰‡çš„å­˜å‚¨æ¡¶

ç™»å½• [å¯¹è±¡å­˜å‚¨æ§åˆ¶å°](https://console.cloud.tencent.com/cos5) ï¼Œ[åˆ›å»ºå­˜å‚¨æ¡¶](https://cloud.tencent.com/document/product/436/13309)ã€‚è®¾ç½®å­˜å‚¨æ¡¶çš„æƒé™ä¸º **`å…¬æœ‰è¯»ï¼Œç§æœ‰å†™`**








![image-20200806135409338](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200806135409338.png)

![image-20200916231600661](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200916231600661.png)



è®¾ç½®corsè§„åˆ™

![image-20200916231949174](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200916231949174.png)

AllowHeader éœ€é…æˆ`*`ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![image-20200805211749522](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805211749522.png)

> å› ä¸ºæˆ‘ä»¬æœ¬èº«æ²¡æœ‰åŸŸåï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®æˆ**`*`**ï¼Œä»…é™äºæµ‹è¯•ï¼Œæ­£å¼ç¯å¢ƒçš„è¯ï¼Œè¿™é‡Œéœ€è¦é…ç½®çœŸå®çš„åŸŸååœ°å€

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„è…¾è®¯äº‘å­˜å‚¨æ¡¶å°±è®¾ç½®å¥½äº†ã€‚





## å°è£…ä¸Šä¼ å›¾ç‰‡ç»„ä»¶-ä¸Šä¼ ç»„ä»¶éœ€æ±‚åˆ†æ

**`ç›®æ ‡`** æ¢³ç†æ•´ä¸ªçš„ä¸Šä¼ è¿‡ç¨‹

**åˆå§‹åŒ–coså¯¹è±¡å‚æ•°**

| åç§°      | æè¿°                                                         |
| :-------- | :----------------------------------------------------------- |
| SecretId  | å¼€å‘è€…æ‹¥æœ‰çš„é¡¹ç›®èº«ä»½è¯†åˆ« IDï¼Œç”¨ä»¥èº«ä»½è®¤è¯ï¼Œå¯åœ¨ [API å¯†é’¥ç®¡ç†](https://console.cloud.tencent.com/capi) é¡µé¢è·å– |
| SecretKey | å¼€å‘è€…æ‹¥æœ‰çš„é¡¹ç›®èº«ä»½å¯†é’¥ï¼Œå¯åœ¨ [API å¯†é’¥ç®¡ç†](https://console.cloud.tencent.com/capi) é¡µé¢è·å– |

> æ³¨æ„ï¼Œä¸Šè¿°çš„å‚æ•°æˆ‘ä»¬åœ¨æœ¬æ¬¡å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç›´æ¥å°†å‚æ•°æ”¾ç½®åœ¨å‰ç«¯ä»£ç ä¸­å­˜å‚¨ï¼Œä½†æ˜¯è…¾è®¯äº‘æœ¬èº«æ˜¯ä¸å»ºè®®è¿™ä¹ˆåšçš„ï¼Œå› ä¸º**`æ•æ„Ÿä¿¡æ¯`**æ”¾åœ¨å‰ç«¯å¾ˆå®¹æ˜“è¢«æ•è·ï¼Œç”±äºæˆ‘ä»¬æœ¬æ¬¡æ˜¯æµ‹è¯•ç ”å‘ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¿½ç•¥
>
> æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ï¼Œé€šè¿‡ç½‘ç«™è°ƒç”¨æ¥å£æ¢å–æ•æ„Ÿä¿¡æ¯

[ç›¸å…³æ–‡æ¡£](https://cloud.tencent.com/document/product/436/11459)

å®ä¾‹åŒ– ä¸Šä¼ sdk

```js
var cos = new COS({
    SecretId: 'COS_SECRETID', // èº«ä»½è¯†åˆ« ID
    SecretKey: 'COS_SECRETKEY', // èº«ä»½å¯†é’¥
});
```

> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡å‡†å¤‡çš„å†…å®¹å°±å·²ç»OKï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨**`src/componets`** æ–°å»ºä¸€ä¸ª**`ImageUpload`** ç»„ä»¶

è¯¥ç»„ä»¶éœ€è¦æ»¡è¶³ä»€ä¹ˆè¦æ±‚å‘¢ï¼Ÿ

1. å¯ä»¥æ˜¾ç¤ºä¼ å…¥çš„å›¾ç‰‡åœ°å€
2. å¯ä»¥åˆ é™¤ä¼ å…¥çš„å›¾ç‰‡åœ°å€
3. å¯ä»¥ä¸Šä¼ å›¾ç‰‡åˆ°äº‘æœåŠ¡å™¨
4. ä¸Šä¼ åˆ°è…¾è®¯äº‘ä¹‹åï¼Œå¯ä»¥è¿”å›å›¾ç‰‡åœ°å€ï¼Œæ˜¾ç¤º  
5. ä¸Šä¼ æˆåŠŸä¹‹åï¼Œå¯ä»¥å›è°ƒæˆåŠŸå‡½æ•°

è¿™ä¸ªä¸Šä¼ ç»„ä»¶ç®€å•å—ï¼Ÿ

æ˜¾ç¤ºæœ¬åœ°å›¾ç‰‡

**`no ! ! !`**

çœ‹ä¼¼éœ€æ±‚å¾ˆæ˜ç¡®ï¼Œä½†æ˜¯å®ƒçœŸæ­£çš„å®ç°å¾ˆå¤æ‚ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå›¾æ¥çœ‹ä¸€ä¸‹

![image-20200806174643390](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200806174643390.png)



ä»ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Šæ˜¯æœ‰ä¸¤ç§åœºæ™¯çš„ï¼Œæœ¬åœ°åœºæ™¯å’Œå·²ç»ä¸Šä¼ çš„åœºæ™¯

ä¸‹ä¸ªç« èŠ‚ï¼Œé’ˆå¯¹è¿™ä¸ªåœºæ™¯æˆ‘ä»¬è¿›è¡Œå¼€å‘



äº§å“è®¾è®¡åŠŸèƒ½



æŸ¥çœ‹å›¾ç‰‡(é¢„è§ˆ)

åˆ é™¤å›¾ç‰‡

é™åˆ¶å›¾ç‰‡å¤§å°å’Œç±»å‹

## å°è£…ä¸Šä¼ ç»„ä»¶-ä»£ç å®ç°

**`ç›®æ ‡`**å®ç°ä¸Šä¼ ç»„ä»¶çš„ä»£ç éƒ¨åˆ†

> JavaScript SDK éœ€æµè§ˆå™¨æ”¯æŒåŸºæœ¬çš„ HTML5 ç‰¹æ€§ï¼ˆæ”¯æŒ IE10 ä»¥ä¸Šæµè§ˆå™¨ï¼‰ï¼Œä»¥ä¾¿æ”¯æŒ ajax ä¸Šä¼ æ–‡ä»¶å’Œè®¡ç®—æ–‡ä»¶ MD5 å€¼ã€‚

### éœ€æ±‚ï¼šæ–°å»ºæ–‡ä»¶ä¸Šä¼ ç»„ä»¶

**å®‰è£…JavaScript SDK**

```bash
$ npm i cos-js-sdk-v5 --save
```

**æ–°å»ºä¸Šä¼ å›¾ç‰‡ç»„ä»¶** **`src/components/ImageUpload/index.vue`**

> ä¸Šä¼ ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ²¿ç”¨elementçš„el-uploadç»„ä»¶,å¹¶ä¸”é‡‡ç”¨ç…§ç‰‡å¢™çš„æ¨¡å¼ `list-type="picture-card"`

[ç»„ä»¶åœ°å€](https://element.eleme.cn/#/zh-CN/component/upload#zhao-pian-qiang)

**æ”¾ç½®el-uploadç»„ä»¶**

<img src="https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20211030231854523.png" alt="image-20211030231854523" style="zoom:25%;" />

```vue
<template>
  <el-upload list-type="picture-card">
     <i class="el-icon-plus" />
  </el-upload>
</template>
```

**å…¨å±€æ³¨å†Œç»„ä»¶**

```js
import PageTools from './PageTools'
import UploadExcel from './UploadExcel'
import ImageUpload from './ImageUpload'
export default {
  install(Vue) {
    Vue.component('PageTools', PageTools) // æ³¨å†Œå·¥å…·æ ç»„ä»¶
    Vue.component('UploadExcel', UploadExcel) // æ³¨å†Œå¯¼å…¥excelç»„ä»¶
    Vue.component('ImageUpload', ImageUpload) // æ³¨å†Œå¯¼å…¥ä¸Šä¼ ç»„ä»¶
  }
}

```

### éœ€æ±‚ï¼šç‚¹å‡»å›¾ç‰‡è¿›è¡Œé¢„è§ˆ

::: tip

å…ˆæŠŠå›¾ç‰‡æ”¾åˆ°ç”¨æˆ·ç»„ä»¶çš„å¤´åƒéƒ¨åˆ†ï¼Œè¿›è¡Œæ•ˆæœçš„æŸ¥çœ‹

/employees/UserInfo/index.vue

```vue
<!-- å‘˜å·¥ç…§ç‰‡ -->
<el-row class="inline-info">
  <el-col :span="12">
    <el-form-item label="å‘˜å·¥å¤´åƒ">
      <!-- æ”¾ç½®ä¸Šä¼ å›¾ç‰‡ -->
      <ImageUpload />
    </el-form-item>
  </el-col>
</el-row>
```

:::

**é¢„è§ˆåŠŸèƒ½**

::: tip

1. éœ€è¦ç»™uploadç»„ä»¶ï¼Œæ·»åŠ on-previewæ–¹æ³•ï¼Œå°±ä¼šè§¦å‘é¢„è§ˆäº‹ä»¶ -> preivewæ–¹æ³•å†…éƒ¨å¯ä»¥è·å–åˆ°å›¾ç‰‡çš„urlé“¾æ¥

2. æ·»åŠ :fileListå±æ€§ä¸ºé¢„è§ˆçš„å›¾ç‰‡åˆ—è¡¨ï¼Œå¯ä»¥ç»™ä¸€ä¸ªé»˜è®¤çš„urlé“¾æ¥ï¼Œå…ˆå®ç°é¢„è§ˆåŠŸèƒ½

3. æ„å»ºä¸€ä¸ªé¢„è§ˆå¼¹å±‚ï¼Œå¼¹å±‚é‡Œé¢å±•ç¤ºä¸€ä¸ªå›¾ç‰‡å°±ok

:::

```js
data() {
    return {
      fileList: [], // å›¾ç‰‡åœ°å€è®¾ç½®ä¸ºæ•°ç»„ 
      showDialog: false, // æ§åˆ¶æ˜¾ç¤ºå¼¹å±‚
      imgUrl: ''
    }
  },
```

```js
     preview(file) {
      // è¿™é‡Œåº”è¯¥å¼¹å‡ºä¸€ä¸ªå±‚ å±‚é‡Œæ˜¯ç‚¹å‡»çš„å›¾ç‰‡åœ°å€
      this.imgUrl = file.url
      this.showDialog = true
  },  
```

**é¢„è§ˆå¼¹å±‚**

```vue
  <el-dialog title="å›¾ç‰‡" :visible.sync="showDialog">
      <img :src="imgUrl" style="width:100%" alt="">
   </el-dialog>
```



### éœ€æ±‚ï¼šæ ¹æ®ä¸Šä¼ æ•°é‡æ§åˆ¶ä¸Šä¼ æŒ‰é’®

::: tip

1. é€šè¿‡limité™åˆ¶ä¸Šä¼ çš„æ•°é‡
2. å¦‚æœç›®å‰å·²ç»ä¸Šä¼ çš„å›¾ç‰‡çš„æ•°é‡=1ï¼Œåˆ™éšè—ä¸Šä¼ æ¡†
   1. é€šè¿‡æ ·å¼æ·»åŠ ç±»åï¼Œéšè—ä¸Šä¼ æŒ‰é’®å³å¯
3. é€šè¿‡actionå±æ€§æŒ‡å®šä¸Šä¼ åœ°å€ï¼Œæš‚æ—¶å†™ä¸º#ï¼Œé˜²æ­¢æŠ¥é”™

:::

```vue
<template>
  <el-upload list-type="picture-card" :limit="1" action="#">
  </el-upload>
</template>
```

> actionä¸ºä»€ä¹ˆç»™#ï¼Œ å› ä¸ºå‰é¢æˆ‘ä»¬è®²è¿‡äº†ï¼Œæˆ‘ä»¬è¦ä¸Šä¼ åˆ°è…¾è®¯äº‘ï¼Œéœ€è¦è‡ªå®šä¹‰çš„ä¸Šä¼ æ–¹å¼,actionç»™ä¸ª#é˜²æ­¢æŠ¥é”™



**æ§åˆ¶ä¸Šä¼ æ˜¾ç¤º**

```js
 computed: {
    // è®¾å®šä¸€ä¸ªè®¡ç®—å±æ€§ åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å®Œäº†ä¸€å¼ 
    fileComputed() {
      return this.fileList.length === 1
    }
  },
```

```css
 <el-upload
      :on-preview="preview"
      :on-remove="handleRemove"
      :on-change="changeFile"
      :file-list="fileList"
      list-type="picture-card"
      action="#"
      :limit="1"
      :class="{disabled: fileComputed }"
    >

<style>
.disabled .el-upload--picture-card {
  display: none
}
</style>

```

### éœ€æ±‚ï¼šåˆ é™¤å›¾ç‰‡å’Œæ·»åŠ å›¾ç‰‡

:::tip

1. åˆ é™¤çš„æ—¶å€™éœ€è¦æ–‡ä»¶åˆ—è¡¨é‡Œé¢çš„å›¾ç‰‡ï¼Œæ ¹æ®åˆ é™¤è§¦å‘æ–¹æ³•è·å–åˆ°çš„uidè¿›è¡Œåˆ¤æ–­
   1. å®šä¹‰fileListçš„æ—¶å€™ï¼Œæºç å†…éƒ¨ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ·»åŠ å½“å‰å›¾ç‰‡çš„uidå’ŒsuccessçŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨uidè¿›è¡Œåˆ¤æ–­
   2. ç»‘å®š:on-removeæ–¹æ³•è¿›è¡Œå›¾ç‰‡çš„åˆ é™¤

:::



<img src="https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20220122191843108.png" alt="image-20220122191843108" style="zoom:50%;" />

```js
	 handleRemove(file) {
      // fileæ˜¯ç‚¹å‡»åˆ é™¤çš„æ–‡ä»¶
    //   å°†åŸæ¥çš„æ–‡ä»¶ç»™æ’é™¤æ‰äº† å‰©ä¸‹çš„å°±æ˜¯æœ€æ–°çš„æ•°ç»„äº†
      this.fileList = this.fileList.filter(item => item.uid !== file.uid)
    },
```

**æ·»åŠ æ–‡ä»¶**

> ä¼šè§¦å‘onChangeæ–¹æ³•,éœ€è¦ç»™uploadä¼ é€’æ­¤æ–¹æ³•ï¼Œå¯ä»¥æ¥æ”¶å½“å‰ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶å’Œå®Œæ•´çš„æ–‡ä»¶åˆ—è¡¨

```js
    // ä¿®æ”¹æ–‡ä»¶æ—¶è§¦å‘
    // æ­¤æ—¶å¯ä»¥ç”¨fileList å› ä¸ºè¯¥æ–¹æ³•ä¼šè¿›æ¥å¾ˆå¤šé ä¸èƒ½æ¯æ¬¡éƒ½å»push
    // fileListå› ä¸ºfileListå‚æ•°æ˜¯å½“å‰ä¼ è¿›æ¥çš„æœ€æ–°å‚æ•° æˆ‘ä»¬åªéœ€è¦å°†å…¶è½¬åŒ–æˆæ•°ç»„å³å¯ éœ€è¦è½¬åŒ–æˆä¸€ä¸ªæ–°çš„æ•°ç»„
    // [] => [...fileList] [] => fileList.map()
    // ä¸Šä¼ æˆåŠŸä¹‹å è¿˜ä¼šè¿›æ¥ éœ€è¦å®ç°ä¸Šä¼ ä»£ç çš„é€»è¾‘ è¿™é‡Œæ‰ä¼šæˆåŠŸ
    changeFile(file, fileList) {
      // filelist ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶åˆ—è¡¨
      this.fileList = fileList.map(item => item)
    }
```

### éœ€æ±‚ï¼šä¸Šä¼ ä¹‹å‰æ£€æŸ¥

:::tip åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹å’Œå¤§å°

1. uploadç»‘å®šbeforeUploadäº‹ä»¶è¿›è¡Œä¸Šä¼ å‰çš„æ£€æŸ¥

2. æ§åˆ¶ä¸Šä¼ å›¾ç‰‡çš„ç±»å‹å’Œä¸Šä¼ å¤§å°ï¼Œ å¦‚æœä¸æ»¡è¶³æ¡ä»¶ è¿”å›falseä¸Šä¼ å°±ä¼šåœæ­¢

:::

| å‚æ•°          |                             è¯´æ˜                             |
| ------------- | :----------------------------------------------------------: |
| before-upload | ä¸Šä¼ æ–‡ä»¶ä¹‹å‰çš„é’©å­ï¼Œå‚æ•°ä¸ºä¸Šä¼ çš„æ–‡ä»¶ï¼Œè‹¥è¿”å› false æˆ–è€…è¿”å› Promise ä¸”è¢« rejectï¼Œåˆ™åœæ­¢ä¸Šä¼ ã€‚ |

```js
    beforeUpload(file) {
      // è¦å¼€å§‹åšæ–‡ä»¶ä¸Šä¼ çš„æ£€æŸ¥äº†
      // æ–‡ä»¶ç±»å‹ æ–‡ä»¶å¤§å°
      const types = ['image/jpeg', 'image/gif', 'image/bmp', 'image/png']
      if (!types.includes(file.type)) {
        this.$message.error('ä¸Šä¼ å›¾ç‰‡åªèƒ½æ˜¯ JPGã€GIFã€BMPã€PNG æ ¼å¼!')
        return false
      }
      //  æ£€æŸ¥å¤§å° 
      const maxSize = 5 * 1024 * 1024 // 1M=1024KB 1KB = 1024B
      if (maxSize < file.size) {
        this.$message.error('å›¾ç‰‡å¤§å°æœ€å¤§ä¸èƒ½è¶…è¿‡5M')
        return false
      }
      return true
    }
```

### éœ€æ±‚ï¼šä¸Šä¼ å›¾ç‰‡åˆ°è…¾è®¯äº‘

:::tip

ä¸ä½¿ç”¨é»˜è®¤çš„ä¸Šä¼ æ–¹æ³•

ä¸Šä¼ åŠ¨ä½œä¸ºel-uploadçš„http-requestå±æ€§

:::

> ä»€ä¹ˆæ—¶å€™ä¸Šä¼ å‡ºé”™ å¦‚æœuploadæ–¹æ³•è¿”å›promise.reject('é”™è¯¯ä¿¡æ¯')è¡¨ç¤ºä¸Šä¼ å‡ºé”™,å…¶ä»–éƒ½ä¼šæˆåŠŸ

```js
 :http-request="upload"

    // è‡ªå®šä¹‰ä¸Šä¼ åŠ¨ä½œ æœ‰ä¸ªå‚æ•° æœ‰ä¸ªfileå¯¹è±¡ï¼Œæ˜¯æˆ‘ä»¬éœ€è¦ä¸Šä¼ åˆ°è…¾è®¯äº‘æœåŠ¡å™¨çš„å†…å®¹
		
    upload(params) {
      console.log(params.file)
    }

```

> æˆ‘ä»¬éœ€è¦åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œè°ƒç”¨è…¾è®¯äº‘çš„ä¸Šä¼ æ–¹æ³•

[è…¾è®¯äº‘æ–‡æ¡£åœ°å€](https://cloud.tencent.com/document/product/436/35649#.E7.AE.80.E5.8D.95.E4.B8.8A.E4.BC.A0.E5.AF.B9.E8.B1.A1)

èº«ä»½IDå’Œå¯†é’¥å¯ä»¥é€šè¿‡è…¾è®¯äº‘å¹³å°è·å–

ç™»å½• [è®¿é—®ç®¡ç†æ§åˆ¶å°](https://console.cloud.tencent.com/capi) ï¼Œè·å–æ‚¨çš„é¡¹ç›® SecretId å’Œ SecretKeyã€‚

![image-20200805211539544](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200805211539544.png)

å®ç°ä»£ç 

ä¸Šä¼ ä¹‹å‰éœ€è¦å®šä¹‰åˆå§‹åŒ–è…¾è®¯äº‘çš„é…ç½®

:::tip

è®°å¾—å®‰è£…ç¬¬ä¸‰æ–¹åŒ…

:::

`import COS from 'cos-js-sdk-v5'` // å¼•å…¥è…¾è®¯äº‘çš„åŒ…

```js
// éœ€è¦å®ä¾‹åŒ–
const cos = new COS({
  SecretId: 'AKID0mqfEWqlUzIbeSkGRL6c7ML6c0B93To9',
  SecretKey: 'JFwNZdeRF2iOp03FFsGNDm44vWFitmNF'
})
// å®ä¾‹åŒ–çš„åŒ… å·²ç»å…·æœ‰äº†ä¸Šä¼ çš„èƒ½åŠ› å¯ä»¥ä¸Šä¼ åˆ°è¯¥è´¦å·é‡Œé¢çš„å­˜å‚¨æ¡¶äº†
```

[é…ç½®ä¿¡æ¯è·å–](https://console.cloud.tencent.com/cos5/bucket?bucket=wuxiaohui-1254415986&region=ap-nanjing&type=bucketoverview)

<img src="https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20220122200146552.png" alt="image-20220122200146552" style="zoom:50%;" />

```js
    // è¿›è¡Œä¸Šä¼ æ“ä½œ
    upload(params) {
    //   console.log(params.file)
      if (params.file) {
        // æ‰§è¡Œä¸Šä¼ æ“ä½œ
        cos.putObject({
          Bucket: 'shuiruohanyu-106-1302806742', // å­˜å‚¨æ¡¶
          Region: 'ap-beijing', // åœ°åŸŸ
          Key: params.file.name, // æ–‡ä»¶å
          Body: params.file, // è¦ä¸Šä¼ çš„æ–‡ä»¶å¯¹è±¡
          StorageClass: 'STANDARD' // ä¸Šä¼ çš„æ¨¡å¼ç±»å‹ ç›´æ¥é»˜è®¤ æ ‡å‡†æ¨¡å¼å³å¯
          // ä¸Šä¼ åˆ°è…¾è®¯äº‘ =ã€‹ å“ªä¸ªå­˜å‚¨æ¡¶ å“ªä¸ªåœ°åŸŸçš„å­˜å‚¨æ¡¶ æ–‡ä»¶  æ ¼å¼  åç§° å›è°ƒ
        }, function(err, data) {
          // dataè¿”å›æ•°æ®ä¹‹å åº”è¯¥å¦‚ä½•å¤„ç†
          console.log(err || data)
        })
      }
    }
```

```json
{
    "statusCode": 200,
    "headers": {
        "content-length": "0",
        "etag": "\"c06c4af2afa85d1412bc36c3ff138c02\"",
        "x-cos-request-id": "NjFlYmYzNWNfOTE1MGI3MDlfMmRjOTFfOThkOTk3MA=="
    },
    "Location": "wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/9R9Z8PHwo2E.jpg",
    "ETag": "\"c06c4af2afa85d1412bc36c3ff138c02\"",
    "RequestId": "NjFlYmYzNWNfOTE1MGI3MDlfMmRjOTFfOThkOTk3MA=="
}
```

ä»¥ä¸Šä¸ºæˆåŠŸæ—¶å€™çš„æ•°æ®ç±»å‹

### éœ€æ±‚ï¼šä¸Šä¼ æˆåŠŸä¹‹åå¤„ç†è¿”å›æ•°æ®

::: tip æ€è€ƒ

è¿”å›çš„å›¾ç‰‡çš„é“¾æ¥æ”¾åˆ°ä»€ä¹ˆåœ°æ–¹å»ï¼Ÿ

filelistæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ€ä¹ˆå†³å®šæ”¾åˆ°å“ªä¸ªå…·ä½“çš„é¡¹é‡Œé¢å»

:::

ç¡®å®šè¦ä¸Šä¼ è®°å½•id

```js
  beforeUpload(file) {
      //   å…ˆæ£€æŸ¥æ–‡ä»¶ç±»å‹
      const types = ['image/jpeg', 'image/gif', 'image/bmp', 'image/png']
      if (!types.some(item => item === file.type)) {
        //   å¦‚æœä¸å­˜åœ¨
        this.$message.error('ä¸Šä¼ å›¾ç‰‡åªèƒ½æ˜¯ JPGã€GIFã€BMPã€PNG æ ¼å¼!')
        return false // ä¸Šä¼ ç»ˆæ­¢
      }
      // æ£€æŸ¥æ–‡ä»¶å¤§å°  5M 1M = 1024KB 1KB = 1024B
      const maxSize = 5 * 1024 * 1024
      if (file.size > maxSize) {
        //   è¶…è¿‡äº†é™åˆ¶çš„æ–‡ä»¶å¤§å°
        this.$message.error('ä¸Šä¼ çš„å›¾ç‰‡å¤§å°ä¸èƒ½å¤§äº5M')
        return false
      }
      //   å·²ç»ç¡®å®šå½“å‰ä¸Šä¼ çš„å°±æ˜¯å½“å‰çš„è¿™ä¸ªfileäº†
      this.currentFileUid = file.uid
      return true // æœ€åä¸€å®šè¦return  true
    },
```

::: warning 

1. å¤„ç†è¿”å›æ•°æ®(å¤„ç†è¿”å›æ•°æ®è®°å¾—å›è°ƒå‡½æ•°å˜æˆå‰ªå¤´å‡½æ•°ï¼Œå¦åˆ™thisæŒ‡å‘ä¼šå‡ºé”™)
2. å¤„ç†è¿”å›çš„åœ°å€çš„æ—¶å€™ï¼Œéœ€è¦æ‹¼æ¥httpåè®®

:::

```js
    // è¿›è¡Œä¸Šä¼ æ“ä½œ
    upload(params) {
    //   console.log(params.file)
      if (params.file) {
        // æ‰§è¡Œä¸Šä¼ æ“ä½œ
        cos.putObject({
          Bucket: 'shuiruohanyu-106-1302806742', // å­˜å‚¨æ¡¶
          Region: 'ap-beijing', // åœ°åŸŸ
          Key: params.file.name, // æ–‡ä»¶å
          Body: params.file, // è¦ä¸Šä¼ çš„æ–‡ä»¶å¯¹è±¡
          StorageClass: 'STANDARD' // ä¸Šä¼ çš„æ¨¡å¼ç±»å‹ ç›´æ¥é»˜è®¤ æ ‡å‡†æ¨¡å¼å³å¯
          // ä¸Šä¼ åˆ°è…¾è®¯äº‘ =ã€‹ å“ªä¸ªå­˜å‚¨æ¡¶ å“ªä¸ªåœ°åŸŸçš„å­˜å‚¨æ¡¶ æ–‡ä»¶  æ ¼å¼  åç§° å›è°ƒ
        }, (err, data) => {
          // dataè¿”å›æ•°æ®ä¹‹å åº”è¯¥å¦‚ä½•å¤„ç†
          console.log(err || data)
          // dataä¸­æœ‰ä¸€ä¸ªstatusCode === 200 çš„æ—¶å€™è¯´æ˜ä¸Šä¼ æˆåŠŸ
          if (!err && data.statusCode === 200) {
            //   æ­¤æ—¶è¯´æ˜æ–‡ä»¶ä¸Šä¼ æˆåŠŸ  è¦è·å–æˆåŠŸçš„è¿”å›åœ°å€
            // fileListæ‰èƒ½æ˜¾ç¤ºåˆ°ä¸Šä¼ ç»„ä»¶ä¸Š æ­¤æ—¶æˆ‘ä»¬è¦å°†fileListä¸­çš„æ•°æ®çš„urlåœ°å€å˜æˆ ç°åœ¨ä¸Šä¼ æˆåŠŸçš„åœ°å€
            // ç›®å‰è™½ç„¶æ˜¯ä¸€å¼ å›¾ç‰‡ ä½†æ˜¯è¯·æ³¨æ„ æˆ‘ä»¬çš„fileListæ˜¯ä¸€ä¸ªæ•°ç»„
            // éœ€è¦çŸ¥é“å½“å‰ä¸Šä¼ æˆåŠŸçš„æ˜¯å“ªä¸€å¼ å›¾ç‰‡
            this.fileList = this.fileList.map(item => {
              // å»æ‰¾è°çš„uidç­‰äºåˆšåˆšè®°å½•ä¸‹æ¥çš„id
              if (item.uid === this.currentFileUid) {
                // å°†æˆåŠŸçš„åœ°å€èµ‹å€¼ç»™åŸæ¥çš„urlå±æ€§
                return { url: 'http://' + data.Location, upload: true }
                // upload ä¸ºtrue è¡¨ç¤ºè¿™å¼ å›¾ç‰‡å·²ç»ä¸Šä¼ å®Œæ¯• è¿™ä¸ªå±æ€§è¦ä¸ºæˆ‘ä»¬åæœŸåº”ç”¨çš„æ—¶å€™åšæ ‡è®°
                // ä¿å­˜  => å›¾ç‰‡æœ‰å¤§æœ‰å° => ä¸Šä¼ é€Ÿåº¦æœ‰å¿«åˆæ…¢ =>è¦æ ¹æ®æœ‰æ²¡æœ‰uploadè¿™ä¸ªæ ‡è®°æ¥å†³å®šæ˜¯å¦å»ä¿å­˜
              }
              return item
            })
            // å°†ä¸Šä¼ æˆåŠŸçš„åœ°å€ å›å†™åˆ°äº†fileListä¸­ fileListå˜åŒ–  =ã€‹ uploadç»„ä»¶ å°±ä¼šæ ¹æ®fileListçš„å˜åŒ–è€Œå»æ¸²æŸ“è§†å›¾
          }
        })
      }
    }
```

> æˆ‘ä»¬åœ¨fileListä¸­è®¾ç½®äº†å±æ€§ä¸ºuploadä¸ºtrueçš„å±æ€§ï¼Œè¡¨ç¤ºè¯¥å›¾ç‰‡å·²ç»ä¸Šä¼ æˆåŠŸäº†ï¼Œå¦‚æœfileListè¿˜æœ‰uploadä¸ä¸ºtrueçš„æ•°æ®ï¼Œé‚£å°±è¡¨ç¤ºè¯¥å›¾ç‰‡è¿˜æ²¡æœ‰ä¸Šä¼ å®Œæ¯•

### ä¸Šä¼ çš„è¿›åº¦æ¡æ˜¾ç¤º

> ä¸ºäº†å†ä¸Šä¼ å›¾ç‰‡è¿‡ç¨‹ä¸­æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨element-uiçš„è¿›åº¦æ¡æ˜¾ç¤ºå½“å‰çš„ä¸Šä¼ è¿›åº¦

**æ”¾ç½®è¿›åº¦æ¡**

```vue
 <el-progress v-if="showPercent" style="width: 180px" :percentage="percent" />
```

**é€šè¿‡è…¾è®¯äº‘sdkç›‘å¬ä¸Šä¼ è¿›åº¦**

```js
 cos.putObject({
          // é…ç½®
          Bucket: 'laogao-1302806742', // å­˜å‚¨æ¡¶åç§°
          Region: 'ap-guangzhou', // å­˜å‚¨æ¡¶åœ°åŸŸ
          Key: params.file.name, // æ–‡ä»¶åä½œä¸ºkey
          StorageClass: 'STANDARD', // æ­¤ç±»å†™æ­»
          Body: params.file, // å°†æœ¬åœ°çš„æ–‡ä»¶èµ‹å€¼ç»™è…¾è®¯äº‘é…ç½®
          // è¿›åº¦æ¡
          onProgress: (params) => {
            this.percent = params.percent * 100
          }
        }
```

**å®Œæ•´ä»£ç **

```vue
<template>
  <div>
    <!-- æ”¾ç½®ä¸€ä¸ªä¸Šä¼ ç»„ä»¶ -->
    <!-- actionè¿™é‡Œä¸å†™ä¸Šä¼ åœ°å€ å› ä¸ºæˆ‘ä»¬æ˜¯è°ƒç”¨è…¾è®¯äº‘cos ä¸æ˜¯ä¸€ä¸ªåœ°å€å¯ä»¥æå®šçš„ è¦ç”¨è‡ªå®šä¹‰çš„ä¸Šä¼  -->
    <el-upload
      :on-preview="preview"
      :on-remove="handleRemove"
      :on-change="changeFile"
      :before-upload="beforeUpload"
      :file-list="fileList"
      :http-request="upload"
      list-type="picture-card"
      action="#"
      :limit="1"
      :class="{disabled: fileComputed }"
    >
      <i class="el-icon-plus" />
    </el-upload>
    <!-- è¿›åº¦æ¡ -->
    <el-progress v-if="showPercent" style="width: 180px" :percentage="percent" />
    <!-- æ”¾ç½®ä¸€ä¸ªå¼¹å±‚ -->
    <!-- syncä¿®é¥°ç¬¦è‡ªåŠ¨å°†å¼¹å±‚å…³é—­äº† -->
    <el-dialog title="å›¾ç‰‡" :visible.sync="showDialog">
      <img :src="imgUrl" style="width:100%" alt="">
    </el-dialog>
  </div>
</template>

<script>
import COS from 'cos-js-sdk-v5' // å¼•å…¥è…¾è®¯äº‘çš„åŒ…
// éœ€è¦å®ä¾‹åŒ–
const cos = new COS({
  SecretId: 'AKID0mqfEWqlUzIbeSkGRL6c7ML6c0B93To9',
  SecretKey: 'JFwNZdeRF2iOp03FFsGNDm44vWFitmNF'
}) // å®ä¾‹åŒ–çš„åŒ… å·²ç»å…·æœ‰äº†ä¸Šä¼ çš„èƒ½åŠ› å¯ä»¥ä¸Šä¼ åˆ°è¯¥è´¦å·é‡Œé¢çš„å­˜å‚¨æ¡¶äº†
export default {
  data() {
    return {
      fileList: [],
      showDialog: false, // æ§åˆ¶å›¾ç‰‡çš„æ˜¾ç¤ºæˆ–è€…éšè—
      imgUrl: '', // å­˜å‚¨ç‚¹å‡»çš„å›¾ç‰‡åœ°å€
      currentFileUid: '', // ç”¨ä¸€ä¸ªå˜é‡ è®°ä½å½“å‰ä¸Šä¼ çš„å›¾ç‰‡id
      percent: 0,
      showPercent: false // é»˜è®¤ä¸æ˜¾ç¤ºè¿›åº¦æ¡
    }
  },
  computed: {
    // è®¾å®šä¸€ä¸ªè®¡ç®—å±æ€§ åˆ¤æ–­æ˜¯å¦å·²ç»ä¸Šä¼ å®Œäº†ä¸€å¼ 
    fileComputed() {
      return this.fileList.length === 1
    }
  },
  methods: {
    preview(file) {
      // è¿™é‡Œåº”è¯¥å¼¹å‡ºä¸€ä¸ªå±‚ å±‚é‡Œæ˜¯ç‚¹å‡»çš„å›¾ç‰‡åœ°å€
      this.imgUrl = file.url
      this.showDialog = true
    },
    handleRemove(file) {
      // fileæ˜¯ç‚¹å‡»åˆ é™¤çš„æ–‡ä»¶
    //   å°†åŸæ¥çš„æ–‡ä»¶ç»™æ’é™¤æ‰äº† å‰©ä¸‹çš„å°±æ˜¯æœ€æ–°çš„æ•°ç»„äº†
      this.fileList = this.fileList.filter(item => item.uid !== file.uid)
    },
    // ä¿®æ”¹æ–‡ä»¶æ—¶è§¦å‘
    // æ­¤æ—¶å¯ä»¥ç”¨fileList å› ä¸ºè¯¥æ–¹æ³•ä¼šè¿›æ¥å¾ˆå¤šé ä¸èƒ½æ¯æ¬¡éƒ½å»push
    // fileListå› ä¸ºfileListå‚æ•°æ˜¯å½“å‰ä¼ è¿›æ¥çš„æœ€æ–°å‚æ•° æˆ‘ä»¬åªéœ€è¦å°†å…¶è½¬åŒ–æˆæ•°ç»„å³å¯ éœ€è¦è½¬åŒ–æˆä¸€ä¸ªæ–°çš„æ•°ç»„
    // [] => [...fileList] [] => fileList.map()
    // ä¸Šä¼ æˆåŠŸä¹‹å è¿˜ä¼šè¿›æ¥ éœ€è¦å®ç°ä¸Šä¼ ä»£ç çš„é€»è¾‘ è¿™é‡Œæ‰ä¼šæˆåŠŸ
    changeFile(file, fileList) {
      this.fileList = fileList.map(item => item)
    },
    beforeUpload(file) {
      // è¦å¼€å§‹åšæ–‡ä»¶ä¸Šä¼ çš„æ£€æŸ¥äº†
      // æ–‡ä»¶ç±»å‹ æ–‡ä»¶å¤§å°
      const types = ['image/jpeg', 'image/gif', 'image/bmp', 'image/png']
      if (!types.includes(file.type)) {
        this.$message.error('ä¸Šä¼ å›¾ç‰‡åªèƒ½æ˜¯ JPGã€GIFã€BMPã€PNG æ ¼å¼!')
        return false
      }
      //  æ£€æŸ¥å¤§å°
      const maxSize = 5 * 1024 * 1024
      if (maxSize < file.size) {
        this.$message.error('å›¾ç‰‡å¤§å°æœ€å¤§ä¸èƒ½è¶…è¿‡5M')
        return false
      }
      // file.uid
      this.currentFileUid = file.uid // è®°ä½å½“å‰çš„uid
      this.showPercent = true
      return true
    },
    // è‡ªå®šä¹‰ä¸Šä¼ åŠ¨ä½œ æœ‰ä¸ªå‚æ•° æœ‰ä¸ªfileå¯¹è±¡ï¼Œæ˜¯æˆ‘ä»¬éœ€è¦ä¸Šä¼ åˆ°è…¾è®¯äº‘æœåŠ¡å™¨çš„å†…å®¹
    upload(params) {
      if (params.file) {
        //  ä¸Šä¼ æ–‡ä»¶åˆ°è…¾è®¯äº‘
        cos.putObject({
          // é…ç½®
          Bucket: 'laogao-1302806742', // å­˜å‚¨æ¡¶åç§°
          Region: 'ap-guangzhou', // å­˜å‚¨æ¡¶åœ°åŸŸ
          Key: params.file.name, // æ–‡ä»¶åä½œä¸ºkey
          StorageClass: 'STANDARD', // æ­¤ç±»å†™æ­»
          Body: params.file, // å°†æœ¬åœ°çš„æ–‡ä»¶èµ‹å€¼ç»™è…¾è®¯äº‘é…ç½®
          // è¿›åº¦æ¡
          onProgress: (params) => {
            this.percent = params.percent * 100
          }
        }, (err, data) => {
          // éœ€è¦åˆ¤æ–­é”™è¯¯ä¸æˆåŠŸ
          if (!err && data.statusCode === 200) {
            // å¦‚æœæ²¡æœ‰å¤±è´¥è¡¨ç¤ºæˆåŠŸäº†
            // æ­¤æ—¶è®¤ä¸ºä¸Šä¼ æˆåŠŸäº†
            // this.currentFileUid
            // ä»ç„¶æœ‰ä¸ªå°é—®é¢˜ï¼Œ æ¯”å¦‚æ­¤æ—¶æˆ‘ä»¬æ­£åœ¨ä¸Šä¼ ï¼Œä½†æ˜¯è°ƒç”¨äº†ä¿å­˜ï¼Œä¿å­˜åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­è¿›è¡Œï¼Œ
            // æ­¤æ—¶ä¸Šä¼ è¿˜æ²¡æœ‰å®Œæˆ  æ­¤æ—¶å¯ä»¥è¿™æ ·åš ï¼š ç»™æ‰€æœ‰ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ åŠ ä¸€ä¸ªå±æ€§ upload: true
            this.fileList = this.fileList.map(item => {
              if (item.uid === this.currentFileUid) {
                //   uploadä¸ºtrueè¡¨ç¤º è¯¥å›¾ç‰‡å·²ç»æˆåŠŸä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåœ°å€å·²ç»æ˜¯è…¾è®¯äº‘çš„åœ°å€äº†  å°±ä¸å¯ä»¥æ‰§è¡Œä¿å­˜äº†
                return { url: 'http://' + data.Location, upload: true } // å°†æœ¬åœ°çš„åœ°å€æ¢æˆè…¾è®¯äº‘åœ°å€
              }
              return item
            })
            setTimeout(() => {
              this.showPercent = false // éšè—è¿›åº¦æ¡
              this.percent = 0 // è¿›åº¦å½’0
            }, 2000)

            // å°†è…¾è®¯äº‘åœ°å€å†™å…¥åˆ°fileListä¸Š ï¼Œä¿å­˜çš„æ—¶å€™ å°±å¯ä»¥ä»fileListä¸­ç›´æ¥è·å–å›¾ç‰‡åœ°å€

            // æ­¤æ—¶æ³¨æ„ï¼Œæˆ‘ä»¬åº”è¯¥è®°ä½ å½“å‰ä¸Šä¼ çš„æ˜¯å“ªä¸ªå›¾ç‰‡  ä¸Šä¼ æˆåŠŸä¹‹åï¼Œå°†å›¾ç‰‡çš„åœ°å€èµ‹å€¼å›å»
          }
        })
      }
    }
  }
}
</script>

<style>
.disabled .el-upload--picture-card {
  display: none
}
</style>

```

> ä¸Šä¼ åŠ¨ä½œä¸­ï¼Œç”¨åˆ°äº†ä¸Šä¸ªå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ³¨å†Œçš„è…¾è®¯äº‘cosçš„**`å­˜å‚¨æ¡¶åç§°`**å’Œ**`åœ°åŸŸåç§°`**

é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œæˆ‘ä»¬æŠŠä¸Šä¼ ä¹‹åçš„å›¾ç‰‡ä¿¡æ¯éƒ½ç»™äº†**`fileListæ•°æ®`**ï¼Œé‚£ä¹ˆåœ¨åº”ç”¨æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥è·å–è¯¥å®ä¾‹çš„**`fileListæ•°æ®å³å¯`**

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`** å®Œæˆä¸Šä¼ ç»„ä»¶çš„å°è£…

## åœ¨å‘˜å·¥è¯¦æƒ…ä¸­åº”ç”¨ä¸Šä¼ ç»„ä»¶

**`ç›®æ ‡`**ï¼šåº”ç”¨å°è£…å¥½çš„ä¸Šä¼ ç»„ä»¶

::: tip ä¸ŠåŠéƒ¨åˆ†ç”¨æˆ·ä¿¡æ¯æ•°æ®

æ¥å£ï¼šgetUserDetailById

è°ƒç”¨æ–¹æ³•: getUserDetailById

dataé‡Œé¢çš„keyå­—æ®µï¼šuserInfo

å›¾ç‰‡ç±»å‹ï¼šå¤´åƒ

å›¾ç‰‡çš„refï¼šavatarRef

:::

:::tip ä¸‹åŠéƒ¨åˆ†æ•°æ®ä¸ªäººè¯¦ç»†ä¿¡æ¯

æ¥å£ï¼šgetPersonalDetail

è°ƒç”¨æ–¹æ³•: getPersonalDetail

dataé‡Œé¢çš„keyå­—æ®µï¼šformData

å›¾ç‰‡ç±»å‹ï¼šå‘˜å·¥ç…§ç‰‡

å›¾ç‰‡çš„refï¼špersonalRef

:::

### å°†å‘˜å·¥çš„å¤´åƒå’Œè¯ä»¶ç…§èµ‹å€¼ç»™ä¸Šä¼ ç»„ä»¶

åœ¨**`user-info.vue`**ä¸­æ”¾ç½®ä¸Šä¼ ç»„ä»¶

**å‘˜å·¥å¤´åƒ**

```vue
  <!-- å‘˜å·¥ç…§ç‰‡ -->
      <el-row class="inline-info">
        <el-col :span="12">
          <el-form-item label="å‘˜å·¥å¤´åƒ">
            <!-- æ”¾ç½®ä¸Šä¼ å›¾ç‰‡ -->
            <image-upload ref="staffPhoto" />
          </el-form-item>
        </el-col>
      </el-row>
```

**è¯»å–æ—¶èµ‹å€¼å¤´åƒ**

```js
 // è¯»å–ä¸ŠåŠéƒ¨åˆ†çš„å†…å®¹
    async getUserDetailById() {
      this.userInfo = await getUserDetailById(this.userId)
        if (this.userInfo.staffPhoto) {
        // è¿™é‡Œæˆ‘ä»¬èµ‹å€¼ï¼ŒåŒæ—¶éœ€è¦ç»™èµ‹å€¼çš„åœ°å€ä¸€ä¸ªæ ‡è®° upload: true
        this.$refs.staffPhoto.fileList = [{ url: this.userInfo.staffPhoto, upload: true }]
      }
    },
```

**å‘˜å·¥è¯ä»¶ç…§**

```vue
  <el-form-item label="å‘˜å·¥ç…§ç‰‡">
          <!-- æ”¾ç½®ä¸Šä¼ å›¾ç‰‡ -->
          <!-- refä¸è¦é‡å -->
          <image-upload ref="myStaffPhoto" />
        </el-form-item>
```

**è¯»å–æ—¶èµ‹å€¼ç…§ç‰‡**

```js
 // è¯»å–ä¸‹åŠéƒ¨åˆ†å†…å®¹
    async  getPersonalDetail() {
      this.formData = await getPersonalDetail(this.userId)
      if (this.formData.staffPhoto) {
        this.$refs.myStaffPhoto.fileList = [{ url: this.formData.staffPhoto, upload: true }]
      }
    },
```

### ä¿å­˜æ—¶å¤„ç†å¤´åƒå’Œè¯ä»¶ç…§çš„ä¿å­˜

**å½“ç‚¹å‡»ä¿å­˜æ›´æ–°æ—¶ï¼Œè·å–å›¾ç‰‡çš„å†…å®¹**

```js
  async  saveUser() {
      // å»è¯»å– å‘˜å·¥ä¸Šä¼ çš„å¤´åƒ
      const fileList = this.$refs.staffPhoto.fileList // è¯»å–ä¸Šä¼ ç»„ä»¶çš„æ•°æ®
      if (fileList.some(item => !item.upload)) {
        //  å¦‚æœæ­¤æ—¶å»æ‰¾ uploadä¸ºfalseçš„å›¾ç‰‡ æ‰¾åˆ°äº†è¯´æ˜ æœ‰å›¾ç‰‡è¿˜æ²¡æœ‰ä¸Šä¼ å®Œæˆ
        this.$message.warning('æ‚¨å½“å‰è¿˜æœ‰å›¾ç‰‡æ²¡æœ‰ä¸Šä¼ å®Œæˆï¼')
        return
      }
      // é€šè¿‡åˆå¹¶ å¾—åˆ°ä¸€ä¸ªæ–°å¯¹è±¡
      await saveUserDetailById({ ...this.userInfo, staffPhoto: fileList && fileList.length ? fileList[0].url : '' })
      this.$message.success('ä¿å­˜åŸºæœ¬ä¿¡æ¯æˆåŠŸ')
    },
```

> ä¸Šé¢ä»£ç ä¸­ï¼Œuploadå¦‚æœä¸ºtrueï¼Œè¡¨ç¤ºè¯¥å›¾ç‰‡å·²ç»å®Œæˆä¸Šä¼ ï¼Œä»¥æ­¤æ¥åˆ¤æ–­å›¾ç‰‡æ˜¯å¦å·²ç»ä¸Šä¼ å®Œæˆ

**ä¿å­˜æ—¶è¯»å–å¤´åƒ**

```js
   async savePersonal() {
      const fileList = this.$refs.myStaffPhoto.fileList
      if (fileList.some(item => !item.upload)) {
        //  å¦‚æœæ­¤æ—¶å»æ‰¾ uploadä¸ºfalseçš„å›¾ç‰‡ æ‰¾åˆ°äº†è¯´æ˜ æœ‰å›¾ç‰‡è¿˜æ²¡æœ‰ä¸Šä¼ å®Œæˆ
        this.$message.warning('æ‚¨å½“å‰è¿˜æœ‰å›¾ç‰‡æ²¡æœ‰ä¸Šä¼ å®Œæˆï¼')
        return
      }
      await updatePersonal({ ...this.formData, staffPhoto: fileList && fileList.length ? fileList[0].url : '' })
      this.$message.success('ä¿å­˜åŸºç¡€ä¿¡æ¯æˆåŠŸ')
    }
```

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`** ï¼š åœ¨å‘˜å·¥è¯¦æƒ…ä¸­åº”ç”¨ä¸Šä¼ ç»„ä»¶

## å‘˜å·¥åˆ—è¡¨æ˜¾ç¤ºå›¾ç‰‡

**`ç›®æ ‡`**ï¼šåœ¨å‘˜å·¥åˆ—è¡¨ä¸­å¿ƒæ˜¾ç¤ºå›¾ç‰‡

> å‘˜å·¥çš„å¤´åƒå¯ä»¥åœ¨åˆ—è¡¨é¡¹ä¸­æ·»åŠ ä¸€åˆ—æ¥è¿›è¡Œæ˜¾ç¤º

```vue
<el-table-column label="å¤´åƒ" align="center">
            <template slot-scope="{row}">
              <img
                slot="reference"
                v-imageerror="require('@/assets/common/bigUserHeader.png')"
                :src="row.staffPhoto "
                style="border-radius: 50%; width: 100px; height: 100px; padding: 10px"
                alt=""
              >
            </template>
</el-table-column>
```

> æˆ‘ä»¬å°è¯•ç”¨ä¹‹å‰çš„æŒ‡ä»¤æ¥å¤„ç†å›¾ç‰‡çš„å¼‚å¸¸é—®é¢˜ï¼Œä½†æ˜¯å‘ç°åªæœ‰ä¸¤ä¸‰å¼ å›¾ç‰‡èƒ½æ˜¾ç¤º

![image-20201028172654637](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20201028172654637.png)

> è¿™æ˜¯å› ä¸ºæœ‰çš„å‘˜å·¥çš„å¤´åƒçš„åœ°å€ä¸ºç©ºï¼Œç»™imgèµ‹å€¼ç©ºçš„srcä¸èƒ½è§¦å‘é”™è¯¯äº‹ä»¶ï¼Œé’ˆå¯¹è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æŒ‡ä»¤è¿›è¡Œå‡çº§

æ’å…¥èŠ‚ç‚¹çš„é’©å­é‡Œé¢åˆ¤æ–­ç©ºï¼Œ ç„¶ååœ¨ç»„ä»¶æ›´æ–°ä¹‹åçš„é’©å­ä¸­åŒæ ·åˆ¤æ–­ç©º

```js
export const imageerror = {
  inserted(dom, options) {
    //   å›¾ç‰‡å¼‚å¸¸çš„é€»è¾‘
    //  ç›‘å¬imgæ ‡ç­¾çš„é”™è¯¯äº‹ä»¶  å› ä¸ºå›¾ç‰‡åŠ è½½å¤±è´¥ ä¼šè§¦å‘  onerroräº‹ä»¶
    dom.src = dom.src || options.value

    dom.onerror = function() {
      // å›¾ç‰‡å¤±è´¥  èµ‹å€¼ä¸€ä¸ªé»˜è®¤çš„å›¾ç‰‡
      dom.src = options.value
    }
  },
  componentUpdated(dom, options) {
    dom.src = dom.src || options.value
  }
}

```

è¿™æ ·æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªç”¨æˆ·çš„å¤´åƒäº†ï¼Œå¦‚æœæ²¡æœ‰å¤´åƒåˆ™æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡

![image-20201028173333103](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20201028173333103.png)

**`ä»»åŠ¡`**ï¼šå‘˜å·¥åˆ—è¡¨æ˜¾ç¤ºå›¾ç‰‡

## å›¾ç‰‡åœ°å€ç”ŸæˆäºŒç»´ç 

:::tip ç›®æ ‡

æˆ‘ä»¬æƒ³å®Œæˆè¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼Œå½“æˆ‘ä»¬æ‹¥æœ‰å¤´åƒåœ°å€æ—¶ï¼Œå°†å¤´åƒåœ°å€ç”Ÿæˆä¸€ä¸ªäºŒç»´ç ï¼Œç”¨æ‰‹æœºæ‰«ç æ¥è®¿é—®

:::

:::tip å®ç°æ€è·¯

1. æ„å»ºä¸€ä¸ªå¼¹å±‚ -> å†…éƒ¨æ„å»ºä¸€ä¸ªcanvansæ ‡ç­¾ -> canvas ç»‘å®šref
2. ç‚¹å‡»å¤´åƒ -> å¼¹å±‚æ ‡è¯†ä¿®æ”¹ä¸ºtrue -> ä¼ é€’å½“å‰å¤´åƒurl -> nextTickæŠŠcanvansè°ƒç”¨æ–¹æ³•æ›¿æ¢æˆäºŒç»´ç 

:::



é¦–å…ˆï¼Œéœ€è¦å®‰è£…ç”ŸæˆäºŒç»´ç çš„æ’ä»¶

```bash 
$ npm i qrcode
```

> qrcodeçš„ç”¨æ³•æ˜¯

```js
QrCode.toCanvas(dom, info)
```

> domä¸ºä¸€ä¸ªcanvasçš„domå¯¹è±¡ï¼Œ infoä¸ºè½¬åŒ–äºŒç»´ç çš„ä¿¡æ¯

æˆ‘ä»¬å°è¯•å°†canvasæ ‡ç­¾æ”¾åˆ°dialogçš„å¼¹å±‚ä¸­

```vue
    <el-dialog title="äºŒç»´ç " :visible.sync="showCodeDialog" @opened="showQrCode" @close="imgUrl=''">
      <el-row type="flex" justify="center">
        <canvas ref="myCanvas" />
      </el-row>
    </el-dialog>
```

åœ¨ç‚¹å‡»å‘˜å·¥çš„å›¾ç‰‡æ—¶ï¼Œæ˜¾ç¤ºå¼¹å±‚ï¼Œå¹¶å°†å›¾ç‰‡åœ°å€è½¬åŒ–æˆäºŒç»´ç 

```js
    showQrCode(url) {
      // urlå­˜åœ¨çš„æƒ…å†µä¸‹ æ‰å¼¹å‡ºå±‚
      if (url) {
        this.showCodeDialog = true // æ•°æ®æ›´æ–°äº† ä½†æ˜¯æˆ‘çš„å¼¹å±‚ä¼šç«‹åˆ»å‡ºç°å— ï¼Ÿé¡µé¢çš„æ¸²æŸ“æ˜¯å¼‚æ­¥çš„ï¼ï¼ï¼ï¼
        // æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥åœ¨ä¸Šä¸€æ¬¡æ•°æ®æ›´æ–°å®Œæ¯•ï¼Œé¡µé¢æ¸²æŸ“å®Œæ¯•ä¹‹å
        this.$nextTick(() => {
          // æ­¤æ—¶å¯ä»¥ç¡®è®¤å·²ç»æœ‰refå¯¹è±¡äº†
          QrCode.toCanvas(this.$refs.myCanvas, url) // å°†åœ°å€è½¬åŒ–æˆäºŒç»´ç 
          // å¦‚æœè½¬åŒ–çš„äºŒç»´ç åé¢ä¿¡æ¯ æ˜¯ä¸€ä¸ªåœ°å€çš„è¯ å°±ä¼šè·³è½¬åˆ°è¯¥åœ°å€ å¦‚æœä¸æ˜¯åœ°å€å°±ä¼šæ˜¾ç¤ºå†…å®¹
        })
      } else {
        this.$message.warning('è¯¥ç”¨æˆ·è¿˜æœªä¸Šä¼ å¤´åƒ')
      }
    }

```

![image-20201028180651472](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20201028180651472.png)



## æ‰“å°å‘˜å·¥ä¿¡æ¯

**`ç›®æ ‡`** å®Œæˆä¸ªäººä¿¡æ¯å’Œå·¥ä½œä¿¡æ¯çš„æ‰“å°åŠŸèƒ½

### æ–°å»ºæ‰“å°é¡µé¢åŠè·¯ç”±

**åˆ›å»ºé¡µé¢ç»„ä»¶**

Src/views/employees/print.vue

```vue
<template>
  <div class="dashboard-container" id="myPrint">
    <div class="app-container">
      <el-card>
        <el-breadcrumb separator="/" class="titInfo ">
          <el-breadcrumb-item :to="{ path: '/' }">é¦–é¡µ</el-breadcrumb-item>
          <el-breadcrumb-item>
            <router-link :to="{'path':'/employees'}">å‘˜å·¥ç®¡ç†</router-link>
          </el-breadcrumb-item>
          <el-breadcrumb-item>æ‰“å°</el-breadcrumb-item>
        </el-breadcrumb>
        <div v-if="type === 'personal'">
          <h2 class="centInfo">å‘˜å·¥ä¿¡æ¯è¡¨</h2>
          <table cellspacing="0" width="100%" class="tableList">
            <tr class="title">
              <td colspan="8" class="centInfo">åŸºæœ¬ä¿¡æ¯</td>
            </tr>
            <tr>
              <th style="width:10%">å§“å</th>
              <td colspan="6" style="width:80%">{{ formData.username }}</td>
              <td rowspan="5" style="width:10%"><img style="width:155px;height:218px" :src="formData.staffPhoto"></td>

            </tr>
            <tr>
              <th>æ€§åˆ«</th>
              <td colspan="6">{{ formData.sex }}</td>
            </tr>
            <tr>
              <th>æ‰‹æœº</th>
              <td colspan="6">{{ formData.mobile }}</td>
            </tr>
            <tr>
              <th>å‡ºç”Ÿæ—¥æœŸ</th>
              <td colspan="6">{{ formData.dateOfBirth | formatDate }}</td>
            </tr>
            <tr>
              <th>æœ€é«˜å­¦å†</th>
              <td colspan="6">{{ formData.theHighestDegreeOfEducation }}</td>
            </tr>
            <tr>
              <th style="width:10%">æ˜¯å¦å¯ç¼–è¾‘</th>
              <td style="width:35%">{{ formData.isItEditable }}</td>
              <th style="width:10%">æ˜¯å¦éšè—å·ç </th>
              <td colspan="5" style="width:45%">{{ formData.doYouHideNumbers }}</td>
            </tr>
            <tr>
              <th>å›½å®¶åœ°åŒº</th>
              <td>{{ formData.nationalArea }}</td>
              <th>æŠ¤ç…§å·</th>
              <td colspan="5">{{ formData.passportNo }}</td>
            </tr>
            <tr>
              <th>èº«ä»½è¯å·</th>
              <td>{{ formData.idNumber }}</td>
              <th>èº«ä»½è¯ç…§ç‰‡</th>
              <td colspan="5">{{ formData.iDCardPhoto }}</td>
            </tr>
            <tr>
              <th>ç±è´¯</th>
              <td>{{ formData.nativePlace }}</td>
              <th>æ°‘æ—</th>
              <td colspan="5">{{ formData.nation }}</td>
            </tr>
            <tr>
              <th>è‹±æ–‡å</th>
              <td>{{ formData.englishName }}</td>
              <th>å©šå§»çŠ¶å†µ</th>
              <td colspan="5">{{ formData.maritalStatus }}</td>
            </tr>
            <tr>
              <th>å‘˜å·¥ç…§ç‰‡</th>
              <td>{{ formData.staffPhoto }}</td>
              <th>ç”Ÿæ—¥</th>
              <td colspan="5">{{ formData.birthday }}</td>
            </tr>
            <tr>
              <th>å±ç›¸</th>
              <td>{{ formData.zodiac }}</td>
              <th>å¹´é¾„</th>
              <td colspan="5">{{ formData.age }}</td>
            </tr>
            <tr>
              <th>æ˜Ÿåº§</th>
              <td>{{ formData.constellation }}</td>
              <th>è¡€å‹</th>
              <td colspan="5">{{ formData.bloodType }}</td>
            </tr>
            <tr>
              <th>æˆ·ç±æ‰€åœ¨åœ°</th>
              <td>{{ formData.domicile }}</td>
              <th>æ”¿æ²»é¢è²Œ</th>
              <td colspan="5">{{ formData.politicalOutlook }}</td>
            </tr>
            <tr>
              <th>å…¥å…šæ—¶é—´</th>
              <td>{{ formData.timeToJoinTheParty }}</td>
              <th>å­˜æ¡£æœºæ„</th>
              <td colspan="5">{{ formData.archivingOrganization }}</td>
            </tr>
            <tr>
              <th>å­å¥³çŠ¶æ€</th>
              <td>{{ formData.stateOfChildren }}</td>
              <th>å­å¥³æœ‰æ— å•†ä¸šä¿é™©</th>
              <td colspan="5">{{ formData.doChildrenHaveCommercialInsurance }}</td>
            </tr>
            <tr>
              <th>æœ‰æ— è¿æ³•è¿çºªè¡Œä¸º</th>
              <td>{{ formData.isThereAnyViolationOfLawOrDiscipline }}</td>
              <th>æœ‰æ— é‡å¤§ç—…å²</th>
              <td colspan="5">{{ formData.areThereAnyMajorMedicalHistories }}</td>
            </tr>
            <tr class="title">
              <td colspan="8" class="centInfo">é€šè®¯ä¿¡æ¯</td>
            </tr>
            <tr>
              <th>QQ</th>
              <td>{{ formData.qQ }}</td>
              <th>å¾®ä¿¡</th>
              <td colspan="5">{{ formData.weChat }}</td>
            </tr>
            <tr>
              <th>å±…ä½è¯åŸå¸‚</th>
              <td>{{ formData.residenceCardCity }}</td>
              <th>å±…ä½è¯åŠç†æ—¥æœŸ</th>
              <td colspan="5">{{ formData.dateOfResidencePermit }}</td>
            </tr>
            <tr>
              <th>å±…ä½è¯æˆªæ­¢æ—¥æœŸ</th>
              <td>{{ formData.residencePermitDeadline }}</td>
              <th>ç°å±…ä½åœ°</th>
              <td colspan="5">{{ formData.placeOfResidence }}</td>
            </tr>
            <tr>
              <th>é€šè®¯åœ°å€</th>
              <td>{{ formData.postalAddress }}</td>
              <th>è”ç³»æ‰‹æœº</th>
              <td colspan="5">{{ formData.contactTheMobilePhone }}</td>
            </tr>
            <tr>
              <th>ä¸ªäººé‚®ç®±</th>
              <td>{{ formData.personalMailbox }}</td>
              <th>ç´§æ€¥è”ç³»äºº</th>
              <td colspan="5">{{ formData.emergencyContact }}</td>
            </tr>
            <tr>
              <th>ç´§æ€¥è”ç³»ç”µè¯</th>
              <td colspan="7">{{ formData.emergencyContactNumber }}</td>
            </tr>
            <tr class="title">
              <td colspan="8" class="centInfo">è´¦å·ä¿¡æ¯</td>
            </tr>
            <tr>
              <th>ç¤¾ä¿ç”µè„‘å·</th>
              <td>{{ formData.socialSecurityComputerNumber }}</td>
              <th>å…¬ç§¯é‡‘è´¦å·</th>
              <td colspan="5">{{ formData.providentFundAccount }}</td>
            </tr>
            <tr>
              <th>é“¶è¡Œå¡å·</th>
              <td>{{ formData.bankCardNumber }}</td>
              <th>å¼€æˆ·è¡Œ</th>
              <td colspan="5">{{ formData.openingBank }}</td>
            </tr>
            <tr class="title">
              <td colspan="8" class="centInfo">æ•™è‚²ä¿¡æ¯</td>
            </tr>
            <tr>
              <th>å­¦å†ç±»å‹</th>
              <td>{{ formData.educationalType }}</td>
              <th>æ¯•ä¸šå­¦æ ¡</th>
              <td colspan="5">{{ formData.graduateSchool }}</td>
            </tr>
            <tr>
              <th>å…¥å­¦æ—¶é—´</th>
              <td>{{ formData.enrolmentTime }}</td>
              <th>æ¯•ä¸šæ—¶é—´</th>
              <td colspan="5">{{ formData.graduationTime }}</td>
            </tr>
            <tr>
              <th>ä¸“ä¸š</th>
              <td>{{ formData.major }}</td>
              <th>æ¯•ä¸šè¯ä¹¦</th>
              <td colspan="5">{{ formData.graduationCertificate }}</td>
            </tr>
            <tr>
              <th>å­¦ä½è¯ä¹¦</th>
              <td colspan="7">{{ formData.certificateOfAcademicDegree }}</td>
            </tr>
            <tr class="title">
              <td colspan="8" class="centInfo">ä»ä¸šä¿¡æ¯</td>
            </tr>
            <tr>
              <th>ä¸Šå®¶å…¬å¸</th>
              <td>{{ formData.homeCompany }}</td>
              <th>èŒç§°</th>
              <td colspan="5">{{ formData.title }}</td>
            </tr>
            <tr>
              <th>ç®€å†</th>
              <td>{{ formData.resume }}</td>
              <th>æœ‰æ— ç«ä¸šé™åˆ¶</th>
              <td colspan="5">{{ formData.isThereAnyCompetitionRestriction }}</td>
            </tr>
            <tr>
              <th>å‰å…¬å¸ç¦»èŒè¯æ˜</th>
              <td>{{ formData.proofOfDepartureOfFormerCompany }}</td>
              <th>å¤‡æ³¨</th>
              <td colspan="5">{{ formData.remarks }}</td>
            </tr>
          </table>
          <div class="foot">ç­¾å­—ï¼š___________æ—¥æœŸ:___________</div>
        </div>
        <div v-else>
          <h2 class="centInfo">å²—ä½ä¿¡æ¯è¡¨</h2>
          <table cellspacing="0" width="100%" class="tableList">
            <tr class="title">
              <td colspan="4" class="centInfo">åŸºæœ¬ä¿¡æ¯</td>
            </tr>
            <tr>
              <th style="width:10%">å§“å</th>
              <td style="width:40%">{{ formData.username }}</td>
              <th style="width:10%">å…¥èŒæ—¥æœŸ</th>
              <td style="width:40%">{{ formData.dateOfEntry }}</td>
            </tr>
            <tr>
              <th>éƒ¨é—¨</th>
              <td>{{ formData.departmentName }}</td>
              <th>å²—ä½</th>
              <td>{{ formData.post }}</td>
            </tr>
            <tr>
              <th>å·¥ä½œé‚®ç®±</th>
              <td>{{ formData.workMailbox }}</td>
              <th>å·¥å·</th>
              <td>{{ formData.workNumber }}</td>
            </tr>
            <tr>
              <th>è½¬æ­£æ—¥æœŸ</th>
              <td>{{ formData.dateOfCorrection }}</td>
              <th>è½¬æ­£çŠ¶æ€</th>
              <td>{{ formData.stateOfCorrection }}</td>
            </tr>
            <tr>
              <th>èŒçº§</th>
              <td>{{ formData.rank }}</td>
              <th>æ±‡æŠ¥å¯¹è±¡</th>
              <td>{{ formData.reportName }}</td>
            </tr>
            <tr>
              <th>HRBP</th>
              <td>{{ formData.hRBP }}</td>
              <th>è˜ç”¨å½¢å¼</th>
              <td>{{ formData.formOfEmployment }}</td>
            </tr>

            <tr>
              <th>ç®¡ç†å½¢å¼</th>
              <td>{{ formData.formOfManagement }}</td>
              <th>è°ƒæ•´å¸é¾„</th>
              <td>{{ formData.adjustmentAgedays }}</td>
            </tr>
            <tr>
              <th>å¸é¾„</th>
              <td>{{ formData.ageOfDivision }}</td>
              <th>é¦–æ¬¡å‚åŠ å·¥ä½œæ—¶é—´</th>
              <td>{{ formData.workingTimeForTheFirstTime }}</td>
            </tr>

            <tr>
              <th>è°ƒæ•´å·¥é¾„å¤©</th>
              <td>{{ formData.adjustmentOfLengthOfService }}</td>
              <th>å·¥é¾„</th>
              <td>{{ formData.workingYears }}</td>
            </tr>
            <tr>
              <th>çº³ç¨åŸå¸‚</th>
              <td>{{ formData.taxableCity }}</td>
              <th>è½¬æ­£è¯„ä»·</th>
              <td>{{ formData.correctionEvaluation }}</td>
            </tr>
            <tr class="title">
              <td colspan="4" class="centInfo">åˆåŒä¿¡æ¯</td>
            </tr>
            <tr>
              <th>é¦–æ¬¡åˆåŒå¼€å§‹æ—¶é—´</th>
              <td>{{ formData.initialContractStartTime }}</td>
              <th>é¦–æ¬¡åˆåŒç»“æŸæ—¶é—´</th>
              <td>{{ formData.firstContractTerminationTime }}</td>
            </tr>
            <tr>
              <th>ç°åˆåŒå¼€å§‹æ—¶é—´</th>
              <td>{{ formData.currentContractStartTime }}</td>
              <th>ç°åˆåŒç»“æŸæ—¶é—´</th>
              <td>{{ formData.closingTimeOfCurrentContract }}</td>
            </tr>

            <tr>
              <th>åˆåŒæœŸé™</th>
              <td>{{ formData.contractPeriod }}</td>
              <th>åˆåŒæ–‡ä»¶</th>
              <td>{{ formData.contractDocuments }}</td>
            </tr>
            <tr>
              <th>ç»­ç­¾æ¬¡æ•°</th>
              <td colspan="3">{{ formData.renewalNumber }}</td>
            </tr>
            <tr class="title">
              <td colspan="4" class="centInfo">æ‹›è˜ä¿¡æ¯</td>
            </tr>
            <tr>
              <th>å…¶ä»–æ‹›è˜æ¸ é“</th>
              <td>{{ formData.otherRecruitmentChannels }}</td>
              <th>æ‹›è˜æ¸ é“</th>
              <td>{{ formData.recruitmentChannels }}</td>
            </tr>
            <tr>
              <th>ç¤¾æ‹›æ ¡æ‹›</th>
              <td>{{ formData.socialRecruitment }}</td>
              <th>æ¨èä¼ä¸šäºº</th>
              <td>{{ formData.recommenderBusinessPeople }}</td>
            </tr>
          </table>
          <div class="foot">ç­¾å­—ï¼š___________æ—¥æœŸ:___________</div>
        </div>
      </el-card>
    </div>
  </div>
</template>

<script>
import { getPersonalDetail, getJobDetail } from '@/api/employees'
import { getUserDetailById } from '@/api/user'
export default {
  data() {
    return {
      formData: {},
      userId: this.$route.params.id,
      type: this.$route.query.type // æ‰“å°ç±»å‹
    }
  },
  // åˆ›å»ºå®Œæ¯•çŠ¶æ€
  created() {
    this.type === 'personal' ? this.getPersonalDetail() : this.getJobDetail()
  },
  // ç»„ä»¶æ›´æ–°
  methods: {
    async getPersonalDetail() {
      this.formData = await getPersonalDetail(this.userId) // è·å–ä¸ªäººåŸºæœ¬ä¿¡æ¯
    },
    async getJobDetail() {
      const userInfo = await getUserDetailById(this.userId)
      const jobInfo = await getJobDetail(this.userId) // è·å–ä¸ªäººåŸºæœ¬ä¿¡æ¯
      this.formData = { ...userInfo, ...jobInfo }
    }
  }
}
</script>

<style lang="scss">
.foot {
  padding: 30px 0;
  text-align: right;
}
</style>


```

> è¯¥é¡µé¢å†…å®¹å®é™…ä¸Šå°±æ˜¯è¯»å–ä¸ªäººå’Œè¯¦æƒ…çš„æ¥å£æ•°æ®ï¼Œæ ¹æ®ä¼ å…¥çš„typeç±»å‹å†³å®šæ˜¾ç¤ºä¸ªäººè¿˜æ˜¯å²—ä½

typeä¸º**`personal`**æ—¶æ˜¾ç¤ºä¸ªäººï¼Œä¸º**`job`**æ—¶æ˜¾ç¤ºå²—ä½

**æ–°å»ºæ‰“å°é¡µé¢è·¯ç”±** routes/modules/employeesä¸‹é¢æ–°å»ºäºŒçº§å­è·¯ç”±

```js
{
    path: 'print/:id', // äºŒçº§é»˜è®¤è·¯ç”±
    component: () => import('@/views/employees/print'), // æŒ‰éœ€åŠ è½½
    hidden: true,
    meta: {
      title: 'æ‰“å°', // æ ‡è®°å½“å‰è·¯ç”±è§„åˆ™çš„ä¸­æ–‡åç§° åç»­åœ¨åšå·¦ä¾§èœå•æ—¶ ä½¿ç”¨
      icon: 'people'
    }
  }
```

å®Œæˆè¯¦æƒ…åˆ°æ‰“å°çš„è·³è½¬

**ä¸ªäºº**

```vue
 <el-row type="flex" justify="end">
            <el-tooltip content="æ‰“å°ä¸ªäººåŸºæœ¬ä¿¡æ¯">
                <router-link :to="`/employees/print/${userId}?type=personal`">
                  <i class="el-icon-printer" />
                </router-link>
             </el-tooltip>
  </el-row>
```

**å²—ä½**

```vue
  <el-row type="flex" justify="end">
              <el-tooltip content="æ‰“å°å²—ä½ä¿¡æ¯">
                <router-link :to="`/employees/print/${userId}?type=job`">
                  <i class="el-icon-printer"  />
                </router-link>
              </el-tooltip>
    </el-row>
```

### åˆ©ç”¨vue-print-nbè¿›è¡Œæ‰“å°

é¦–å…ˆï¼Œæ‰“å°åŠŸèƒ½æˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªæ¯”è¾ƒæµè¡Œçš„æ’ä»¶

```bash
$ npm i vue-print-nb
```

> å®ƒçš„ç”¨æ³•æ˜¯ 

é¦–å…ˆæ³¨å†Œè¯¥æ’ä»¶

```js
import Print from 'vue-print-nb'
Vue.use(Print);
```

ä½¿ç”¨v-printæŒ‡ä»¤çš„æ–¹å¼è¿›è¡Œæ‰“å°

```vue
  <el-row type="flex" justify="end">
          <el-button v-print="printObj" size="small" type="primary">æ‰“å°</el-button>
   </el-row>
   printObj: {
        id: 'myPrint'
   }
```

æœ€ç»ˆï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ•ˆæœ

![image-20200728013006535](https://wuxiaohui-1254415986.cos.ap-nanjing.myqcloud.com/uPic/image-20200728013006535.png)

**æäº¤ä»£ç **

**`æœ¬èŠ‚ä»»åŠ¡`**æ‰“å°å‘˜å·¥ä¿¡æ¯

